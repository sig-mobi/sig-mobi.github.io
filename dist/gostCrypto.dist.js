/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(d,e){"function"===typeof define&&define.amd?define(e):"object"===typeof exports?module.exports=e():d.gostRandom=e()})(this,function(){var d=this.crypto||this.msCrypto,e=this.TypeMismatchError||Error,h=this.QuotaExceededError||Error,f={seed:new Uint8Array(1024),getIndex:0,setIndex:0,set:function(a){1024<=this.setIndex&&(this.setIndex=0);this.seed[this.setIndex++]=a},get:function(){1024<=this.getIndex&&(this.getIndex=0);return this.seed[this.getIndex++]}};if("undefiend"!==typeof document){try{document.addEventListener("mousemove",
function(a){f.set((new Date).getTime()&255^(a.clientX||a.pageX)&255^(a.clientY||a.pageY)&255)},!1)}catch(k){}try{document.addEventListener("keydown",function(a){f.set((new Date).getTime()&255^a.keyCode&255)},!1)}catch(l){}}return{getRandomValues:function(a){if(!a.byteLength)throw new e("Array is not of an integer type (Int8Array, Uint8Array, Int16Array, Uint16Array, Int32Array, or Uint32Array)");if(65536<a.byteLength)throw new h("Byte length of array can't be greate then 65536");var c=new Uint8Array(a.buffer,
a.byteOffset,a.byteLength);if(d&&d.getRandomValues)d.getRandomValues(c);else for(var b=0,g=c.length;b<g;b++)c[b]=Math.floor(256*Math.random())&255;b=0;for(g=c.length;b<g;b++)c[b]^=f.get();return a}}});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(e,c){"function"===typeof define&&define.amd?define(c):"object"===typeof exports?module.exports=c():e.gostObject=c()})(this,function(){var e=this,c={"1.2.643.2.2":"CryptoPro","1.2.643.2.2.3":"id-GostR3411-94-with-GostR3410-2001","1.2.643.2.2.4":"id-GostR3411-94-with-GostR3410-94","1.2.643.2.2.9":"id-GostR3411-94","1.2.643.2.2.10":"id-HMACGostR3411-94","1.2.643.2.2.13.0":"id-Gost28147-89-None-KeyWrap","1.2.643.2.2.13.1":"id-Gost28147-89-CryptoPro-KeyWrap","1.2.643.2.2.14.0":"id-Gost28147-89-None-KeyMeshing",
"1.2.643.2.2.14.1":"id-Gost28147-89-CryptoPro-KeyMeshing","1.2.643.2.2.19":"id-GostR3410-2001","1.2.643.2.2.20":"id-GostR3410-94","1.2.643.2.2.20.1":"id-GostR3410-94-a","1.2.643.2.2.20.2":"id-GostR3410-94-aBis","1.2.643.2.2.20.3":"id-GostR3410-94-b","1.2.643.2.2.20.4":"id-GostR3410-94-bBis","1.2.643.2.2.21":"id-Gost28147-89","1.2.643.2.2.22":"id-Gost28147-89-MAC","1.2.643.2.2.30.0":"id-GostR3411-94-TestParamSet","1.2.643.2.2.30.1":"id-GostR3411-94-CryptoProParamSet","1.2.643.2.2.30.2":"id-GostR3411-94-CryptoPro-B-ParamSet",
"1.2.643.2.2.30.3":"id-GostR3411-94-CryptoPro-C-ParamSet","1.2.643.2.2.30.4":"id-GostR3411-94-CryptoPro-D-ParamSet","1.2.643.2.2.31.0":"id-Gost28147-89-TestParamSet","1.2.643.2.2.31.1":"id-Gost28147-89-CryptoPro-A-ParamSet","1.2.643.2.2.31.2":"id-Gost28147-89-CryptoPro-B-ParamSet","1.2.643.2.2.31.3":"id-Gost28147-89-CryptoPro-C-ParamSet","1.2.643.2.2.31.4":"id-Gost28147-89-CryptoPro-D-ParamSet","1.2.643.2.2.31.5":"id-Gost28147-89-CryptoPro-Oscar-1-1-ParamSet","1.2.643.2.2.31.6":"id-Gost28147-89-CryptoPro-Oscar-1-0-ParamSet",
"1.2.643.2.2.31.7":"id-Gost28147-89-CryptoPro-RIC-1-ParamSet ","1.2.643.2.2.31.12":"id-Gost28147-89-CryptoPro-tc26-1","1.2.643.2.2.31.13":"id-Gost28147-89-CryptoPro-tc26-2","1.2.643.2.2.31.14":"id-Gost28147-89-CryptoPro-tc26-3","1.2.643.2.2.31.15":"id-Gost28147-89-CryptoPro-tc26-4","1.2.643.2.2.31.16":"id-Gost28147-89-CryptoPro-tc26-5","1.2.643.2.2.31.17":"id-Gost28147-89-CryptoPro-tc26-6","1.2.643.2.2.32.0":"id-GostR3410-94-TestParamSet","1.2.643.2.2.32.2":"id-GostR3410-94-CryptoPro-A-ParamSet",
"1.2.643.2.2.32.3":"id-GostR3410-94-CryptoPro-B-ParamSet","1.2.643.2.2.32.4":"id-GostR3410-94-CryptoPro-C-ParamSet","1.2.643.2.2.32.5":"id-GostR3410-94-CryptoPro-D-ParamSet","1.2.643.2.2.33.1":"id-GostR3410-94-CryptoPro-XchA-ParamSet","1.2.643.2.2.33.2":"id-GostR3410-94-CryptoPro-XchB-ParamSet","1.2.643.2.2.33.3":"id-GostR3410-94-CryptoPro-XchC-ParamSet","1.2.643.2.2.34.2":"temporaryAccessToRC","1.2.643.2.2.34.3":"internetContentSignature","1.2.643.2.2.34.4":"adminRC","1.2.643.2.2.34.5":"operatorRC",
"1.2.643.2.2.34.6":"userRC","1.2.643.2.2.34.7":"clientRC","1.2.643.2.2.34.8":"serverRC","1.2.643.2.2.34.9":"sysAdminRC","1.2.643.2.2.34.10":"arcAdminRC","1.2.643.2.2.34.11":"authorityPersonRC","1.2.643.2.2.34.12":"clientCC","1.2.643.2.2.34.13":"sysAdminCC","1.2.643.2.2.34.14":"arcAdminCC","1.2.643.2.2.34.15":"accessIPSecCA","1.2.643.2.2.34.16":"auditAdminHSM","1.2.643.2.2.34.21":"adminHSM","1.2.643.2.2.34.22":"serverAdminHSH","1.2.643.2.2.34.24":"winlogonCA","1.2.643.2.2.34.25":"timestampServiceUser",
"1.2.643.2.2.34.26":"statusServiceUser","1.2.643.2.2.34.27":"arcAdminHSM","1.2.643.2.2.34.28":"auditorHSM","1.2.643.2.2.35.0":"id-GostR3410-2001-CryptoPro-TestParamSet","1.2.643.2.2.35.1":"id-GostR3410-2001-CryptoPro-A-ParamSet","1.2.643.2.2.35.2":"id-GostR3410-2001-CryptoPro-B-ParamSet","1.2.643.2.2.35.3":"id-GostR3410-2001-CryptoPro-C-ParamSet","1.2.643.2.2.36.0":"id-GostR3410-2001-CryptoPro-XchA-ParamSet","1.2.643.2.2.36.1":"id-GostR3410-2001-CryptoPro-XchB-ParamSet","1.2.643.2.2.37.3.1":"intermediateCertificates",
"1.2.643.2.2.37.3.2":"trustedCertificatesSignature","1.2.643.2.2.37.3.3":"trustedCertificatesExchange","1.2.643.2.2.38.1":"personalBaseProlicy","1.2.643.2.2.38.2":"networkBasePolicy","1.2.643.2.2.47.1":"id-CryptoPro-ocsp-treats-exp-key-or-exp-cert-rev","1.2.643.2.2.47.2":"id-CryptoPro-ocsp-crl-locator","1.2.643.2.2.47.3":"id-CryptoPro-ocsp-instant-revocation-indicator","1.2.643.2.2.47.4":"id-CryptoPro-ocsp-revocation-announcement-reference","1.2.643.2.2.47.5":"id-CryptoPro-ocsp-historical-request",
"1.2.643.2.2.49.2":"limitedLicense","1.2.643.2.2.96":"id-GostR3410-2001-CryptoPro-ESDH","1.2.643.2.2.97":"id-GostR3410-94-CryptoPro-ESDH","1.2.643.2.2.98":"id-GostR3410-2001DH","1.2.643.2.2.99":"id-GostR3410-94DH","1.2.643.3.131.1.1":"INN","1.2.643.3.141.1.1":"RNS FSS","1.2.643.3.141.1.2":"KP FSS","1.2.643.7.1":"tc26","1.2.643.7.1.1.1.1":"id-tc26-gost3410-12-256","1.2.643.7.1.1.1.2":"id-tc26-gost3410-12-512","1.2.643.7.1.1.2.1":"id-tc26-gost3411-94","1.2.643.7.1.1.2.2":"id-tc26-gost3411-12-256","1.2.643.7.1.1.2.3":"id-tc26-gost3411-12-512",
"1.2.643.7.1.1.3.1":"id-tc26-signwithdigest-gost3410-12-94","1.2.643.7.1.1.3.2":"id-tc26-signwithdigest-gost3410-12-256","1.2.643.7.1.1.3.3":"id-tc26-signwithdigest-gost3410-12-512","1.2.643.7.1.1.4.1":"id-tc26-hmac-gost-3411-12-256","1.2.643.7.1.1.4.2":"id-tc26-hmac-gost-3411-12-512","1.2.643.7.1.1.6.1":"id-tc26-agreement-gost-3410-12-256","1.2.643.7.1.1.6.2":"id-tc26-agreement-gost-3410-12-512","1.2.643.7.1.2.1.1.0":"id-tc26-gost-3410-12-256-paramSetTest","1.2.643.7.1.2.1.1.1":"id-tc26-gost-3410-12-256-paramSetA",
"1.2.643.7.1.2.1.1.2":"id-tc26-gost-3410-12-256-paramSetB","1.2.643.7.1.2.1.2.0":"id-tc26-gost-3410-12-512-paramSetTest","1.2.643.7.1.2.1.2.1":"id-tc26-gost-3410-12-512-paramSetA","1.2.643.7.1.2.1.2.2":"id-tc26-gost-3410-12-512-paramSetB","1.2.643.7.1.2.1.2.3":"id-tc26-gost-3410-12-512-paramSetC","1.2.643.7.1.2.1.2.4":"id-tc26-gost-3410-12-512-paramSetD","1.2.643.7.1.2.5.1.1":"id-tc26-gost-28147-param-Z","1.2.643.100.1":"OGRN","1.2.643.100.2.1":"SMEV-person","1.2.643.100.2.2":"SMEV-government","1.2.643.100.3":"SNILS",
"1.2.643.100.4":"KPP","1.2.643.100.5":"OGRNIP","1.2.643.100.6":"internal-government","1.2.643.100.111":"subjectSignTool","1.2.643.100.112":"issuerSignTool","1.2.643.100.113.1":"signToolClassKC1","1.2.643.100.113.2":"signToolClassKC2","1.2.643.100.113.3":"signToolClassKC3","1.2.643.100.113.4":"signToolClassKB1","1.2.643.100.113.5":"signToolClassKB2","1.2.643.100.113.6":"signToolClassKA1","1.2.643.100.114.1":"issuerToolClassKC1","1.2.643.100.114.2":"issuerToolClassKC2","1.2.643.100.114.3":"issuerToolClassKC3",
"1.2.643.100.114.4":"issuerToolClassKB2","1.2.643.100.114.5":"issuerToolClassKB1","1.2.643.100.114.6":"issuerToolClassKA1","1.2.840.10040.4":"x9cm","1.2.840.10040.4.1":"dsa","1.2.840.10040.4.3":"dsa-with-SHA1","1.2.840.10045":"ansi-x962","1.2.840.10045.1":"id-fieldType","1.2.840.10045.1.1":"id-prime-Field","1.2.840.10045.1.2":"id-characteristic-two-field","1.2.840.10045.2.1":"ecPublicKey","1.2.840.10045.3.0":"characteristicTwo","1.2.840.10045.3.1.1":"secp192r1","1.2.840.10045.3.1.2":"prime192v2",
"1.2.840.10045.3.1.3":"prime192v3","1.2.840.10045.3.1.4":"prime239v1","1.2.840.10045.3.1.5":"prime239v2","1.2.840.10045.3.1.6":"prime239v3","1.2.840.10045.3.1.7":"secp256r1","1.2.840.10045.4":"ecdsa","1.2.840.10045.4.1":"ecdsa-with-SHA1","1.2.840.10045.4.2":"ecdsa-with-Recommended","1.2.840.10045.4.4":"ecdsa-with-SHA2","1.2.840.10045.4.4.1":"ecdsa-with-SHA224","1.2.840.10045.4.4.2":"ecdsa-with-SHA256","1.2.840.10045.4.4.3":"ecdsa-with-SHA384","1.2.840.10045.4.4.4":"ecdsa-with-SHA512","1.2.840.113533.7.66.13":"PasswordBasedMac",
"1.3.6.1.4.1.22554.1.1.2.1.2":"pbeWithSHAAndAES128-CBC","1.3.6.1.4.1.22554.1.1.2.1.22":"pbeWithSHAAndAES192-CBC","1.3.6.1.4.1.22554.1.1.2.1.42":"pbeWithSHAAndAES256-CBC","1.3.6.1.4.1.22554.1.2.1.2.1.2":"pbeWithSHA256AndAES128-CBC","1.3.6.1.4.1.22554.1.2.1.2.1.22":"pbeWithSHA256AndAES192-CBC","1.3.6.1.4.1.22554.1.2.1.2.1.42":"pbeWithSHA256AndAES256-CBC","1.2.840.113549":"rsa","1.2.840.113549.1.1.1":"rsaEncryption","1.2.840.113549.1.1.2":"md2withRSAEncryption","1.2.840.113549.1.1.3":"md4withRSAEncryption",
"1.2.840.113549.1.1.4":"md5withRSAEncryption","1.2.840.113549.1.1.5":"sha1withRSAEncryption","1.2.840.113549.1.1.7":"rsaes-oaep","1.2.840.113549.1.1.8":"mgf1","1.2.840.113549.1.1.9":"pSpecified","1.2.840.113549.1.1.10":"rsassa-pss","1.2.840.113549.1.1.11":"sha256withRSAEncryption","1.2.840.113549.1.1.12":"sha384withRSAEncryption","1.2.840.113549.1.1.13":"sha512withRSAEncryption","1.2.840.113549.1.2.7":"hmacWithSHA1","1.2.840.113549.1.2.8":"hmacWithSHA224","1.2.840.113549.1.2.9":"hmacWithSHA256","1.2.840.113549.1.2.10":"hmacWithSHA384",
"1.2.840.113549.1.2.11":"hmacWithSHA512","1.2.840.113549.1.3.1":"dhKeyAgreement","1.2.840.113549.1.5.12":"PBKDF2","1.2.840.113549.1.5.13":"PBES2","1.2.840.113549.1.5.14":"PBMAC1","1.2.840.113549.1.7.1":"data","1.2.840.113549.1.7.2":"signedData","1.2.840.113549.1.7.3":"envelopedData","1.2.840.113549.1.7.4":"signedAndEnvelopedData","1.2.840.113549.1.7.5":"digestedData","1.2.840.113549.1.7.6":"encryptedData","1.2.840.113549.1.9.1":"emailAddress","1.2.840.113549.1.9.2":"unstructuredName","1.2.840.113549.1.9.3":"contentType",
"1.2.840.113549.1.9.4":"messageDigest","1.2.840.113549.1.9.5":"signingTime","1.2.840.113549.1.9.6":"countersignature","1.2.840.113549.1.9.7":"challengePassword","1.2.840.113549.1.9.8":"unstructuredAddress","1.2.840.113549.1.9.9":"extendedCertificateAttributes","1.2.840.113549.1.9.10":"issuerAndSerialNumber","1.2.840.113549.1.9.11":"passwordCheck","1.2.840.113549.1.9.12":"publicKey","1.2.840.113549.1.9.13":"signingDescription","1.2.840.113549.1.9.14":"extensionRequest","1.2.840.113549.1.9.15":"sMimeCapabilities",
"1.2.840.113549.1.9.16":"sMimeObjectIdentifierRegistry","1.2.840.113549.1.9.16.1.2":"authData","1.2.840.113549.1.9.16.1.4 ":"timestampToken","1.2.840.113549.1.9.16.1.17 ":"firmwareLoadReceipt","1.2.840.113549.1.9.16.1.21":"encKeyWithID","1.2.840.113549.1.9.16.1.23":"authEnvelopedData","1.2.840.113549.1.9.16.2":"sMimeAttributes","1.2.840.113549.1.9.16.2.1":"receiptRequest","1.2.840.113549.1.9.16.2.12":"signingCertificate","1.2.840.113549.1.9.16.2.14":"timeStampToken","1.2.840.113549.1.9.16.2.2":"securityLabel",
"1.2.840.113549.1.9.16.2.3":"mlExpansionHistory","1.2.840.113549.1.9.16.2.34":"unsignedData","1.2.840.113549.1.9.16.2.47":"signingCertificateV2","1.2.840.113549.1.9.16.3.5":"ESDH","1.2.840.113549.1.9.20":"friendlyName","1.2.840.113549.1.9.21":"localKeyId","1.2.840.113549.1.9.22":"certTypes","1.2.840.113549.1.9.22.1":"x509Certificate","1.2.840.113549.1.9.22.2":"sdsiCertificate","1.2.840.113549.1.9.23":"crlTypes","1.2.840.113549.1.9.23.1":"x509CRL","1.2.840.113549.1.9.24":"secretTypes","1.2.840.113549.1.9.24.1":"secret",
"1.2.840.113549.1.9.25.1":"pkcs15Token","1.2.840.113549.1.9.25.2":"encryptedPrivateKeyInfo","1.2.840.113549.1.9.25.3":"randomNonce","1.2.840.113549.1.9.25.4":"sequenceNumber","1.2.840.113549.1.9.25.5":"pkcs7PDU","1.2.840.113549.1.9.26.1":"pkcs9String","1.2.840.113549.1.9.26.2":"signingTime","1.2.840.113549.1.9.27.1":"caseIgnoreMatch","1.2.840.113549.1.9.27.2":"signingTimeMatch","1.2.840.113549.1.12.0.1":"pkcs-12","1.2.840.113549.1.12.1":"pbe","1.2.840.113549.1.12.1.1":"pbeWithSHAAnd128BitRC4","1.2.840.113549.1.12.1.2":"pbeWithSHAAnd40BitRC4",
"1.2.840.113549.1.12.1.3":"pbeWithSHAAnd3-KeyTripleDES-CBC","1.2.840.113549.1.12.1.4":"pbeWithSHAAnd2-KeyTripleDES-CBC","1.2.840.113549.1.12.1.5":"pbeWithSHAAnd128BitRC2-CBC","1.2.840.113549.1.12.1.6":"pbewithSHAAnd40BitRC2-CBC","1.2.840.113549.1.12.2.1":"pkcs8-key-shrouding","1.2.840.113549.1.12.3.1":"keyBagId","1.2.840.113549.1.12.3.2":"certAndCRLBagId","1.2.840.113549.1.12.3.3":"secretBagId","1.2.840.113549.1.12.3.4":"safeContentsId","1.2.840.113549.1.12.3.5":"pkcs-8ShroudedKeyBagId","1.2.840.113549.1.12.4.1":"x509CertCRLBagId",
"1.2.840.113549.1.12.4.2":"pkcs-12-SDSICertBag","1.2.840.113549.1.12.10.1.1":"keyBag","1.2.840.113549.1.12.10.1.2":"pkcs8ShroudedKeyBag","1.2.840.113549.1.12.10.1.3":"certBag","1.2.840.113549.1.12.10.1.4":"crlBag","1.2.840.113549.1.12.10.1.5":"secretBag","1.2.840.113549.1.12.10.1.6":"safeContentsBag","1.2.840.113549.2.5":"md-5","1.2.840.113549.3.7":"des-EDE3-CBC","1.3.132.0.34":"secp384r1","1.3.132.0.35":"secp521r1","1.3.132.112":"ecDH","1.3.14.3.2.26":"sha1","1.3.6.1.4.1.311.2.1.14":"msCertExtensions",
"1.3.6.1.4.1.311.17.1":"pkcs-12-key-provider-name-attr","1.3.6.1.4.1.5849":"SignalCom","1.3.6.1.4.1.5849.1.1.1":"id-sc-gost28147-ecb","1.3.6.1.4.1.5849.1.1.2":"id-sc-gost28147-gamma","1.3.6.1.4.1.5849.1.1.3":"id-sc-gost28147-gfb","1.3.6.1.4.1.5849.1.1.4":"id-sc-gost28147-mac","1.3.6.1.4.1.5849.1.1.5":"id-sc-gostR3410-94","1.3.6.1.4.1.5849.1.1.6.1.1.1":"id-sc-gostR3410-94-default","1.3.6.1.4.1.5849.1.1.6.1.1.2":"id-sc-gostR3410-94-test","1.3.6.1.4.1.5849.1.2.1":"id-sc-gostR3411-94","1.3.6.1.4.1.5849.1.3.1":"id-sc-gostR3411-94-with-gostR3410-94",
"1.3.6.1.4.1.5849.1.3.2":"id-sc-gostR3411-94-with-gostR3410-2001","1.3.6.1.4.1.5849.1.4.1":"id-sc-cmsGostWrap","1.3.6.1.4.1.5849.1.4.2":"id-sc-cmsGost28147Wrap","1.3.6.1.4.1.5849.1.5.1":"id-sc-pbeWithGost3411AndGost28147","1.3.6.1.4.1.5849.1.5.2":"id-sc-pbeWithGost3411AndGost28147CFB","1.3.6.1.4.1.5849.1.6.2":"id-sc-gostR3410-2001","1.3.6.1.4.1.5849.1.7.2":"id-sc-hmacWithGostR3411","1.3.6.1.4.1.5849.1.8.1":"id-sc-r3410-ESDH-r3411kdf","1.3.6.1.4.1.5849.1.8.3":"id-sc-ecdh-singlePass-cofactor-r3411kdf",
"1.3.6.1.4.1.5849.2.2.1":"id-sc-gostR3410-2001-publicKey","1.3.6.1.5.5.7.0.12":"attribute-cert","1.3.6.1.5.5.7.1.1":"authorityInfoAccess","1.3.6.1.5.5.7.1.4":"auditIdentity","1.3.6.1.5.5.7.1.6":"aaControls","1.3.6.1.5.5.7.1.10":"ac-proxying","1.3.6.1.5.5.7.1.11":"subjectInfoAccess","1.3.6.1.5.5.7.3.1":"serverAuth","1.3.6.1.5.5.7.3.2":"clientAuth","1.3.6.1.5.5.7.3.3":"codeSigning","1.3.6.1.5.5.7.3.4":"emailProtection","1.3.6.1.5.5.7.3.5":"ipsecEndSystem","1.3.6.1.5.5.7.3.6":"ipsecTunnel","1.3.6.1.5.5.7.3.7":"ipsecUser",
"1.3.6.1.5.5.7.3.8":"timeStamping","1.3.6.1.5.5.7.3.9":"OCSPSigning","1.3.6.1.5.5.7.5.1":"regCtrl","1.3.6.1.5.5.7.5.1.1":"regToken","1.3.6.1.5.5.7.5.1.2":"authenticator","1.3.6.1.5.5.7.5.1.3":"pkiPublicationInfo","1.3.6.1.5.5.7.5.1.4":"pkiArchiveOptions","1.3.6.1.5.5.7.5.1.5":"oldCertID","1.3.6.1.5.5.7.5.1.6":"protocolEncrKey","1.3.6.1.5.5.7.5.2":"regInfo","1.3.6.1.5.5.7.5.2.1":"UTF8Pairs","1.3.6.1.5.5.7.5.2.2":"certReq","1.3.6.1.5.5.7.6.2":"noSignature","1.3.6.1.5.5.7.7.1":"statusInfo","1.3.6.1.5.5.7.7.2":"identification",
"1.3.6.1.5.5.7.7.3":"identityProof","1.3.6.1.5.5.7.7.4":"dataReturn","1.3.6.1.5.5.7.7.5":"transactionId","1.3.6.1.5.5.7.7.6":"senderNonce","1.3.6.1.5.5.7.7.7":"recipientNonce","1.3.6.1.5.5.7.7.8":"addExtensions","1.3.6.1.5.5.7.7.9":"encryptedPOP","1.3.6.1.5.5.7.7.10":"decryptedPOP","1.3.6.1.5.5.7.7.11":"lraPOPWitness","1.3.6.1.5.5.7.7.15":"getCert","1.3.6.1.5.5.7.7.16":"getCRL","1.3.6.1.5.5.7.7.17":"revokeRequest","1.3.6.1.5.5.7.7.18":"regInfo","1.3.6.1.5.5.7.7.19":"responseInfo","1.3.6.1.5.5.7.7.21":"queryPending",
"1.3.6.1.5.5.7.7.22":"popLinkRandom","1.3.6.1.5.5.7.7.23":"popLinkWitness","1.3.6.1.5.5.7.7.24":"confirmCertAcceptance","1.3.6.1.5.5.7.7.25":"statusInfoV2","1.3.6.1.5.5.7.7.26":"trustedAnchors","1.3.6.1.5.5.7.7.27":"authData","1.3.6.1.5.5.7.7.28":"batchRequests","1.3.6.1.5.5.7.7.29":"batchResponses","1.3.6.1.5.5.7.7.30":"publishCert","1.3.6.1.5.5.7.7.31":"modCertTemplate","1.3.6.1.5.5.7.7.32":"controlProcessed","1.3.6.1.5.5.7.7.33":"popLinkWitnessV2","1.3.6.1.5.5.7.7.34":"identityProofV2","1.3.6.1.5.5.7.9.1":"dateOfBirth",
"1.3.6.1.5.5.7.9.2":"placeOfBirth","1.3.6.1.5.5.7.9.3":"gender","1.3.6.1.5.5.7.9.4":"countryOfCitizenship","1.3.6.1.5.5.7.9.5":"countryOfResidence","1.3.6.1.5.5.7.10.1":"authenticationInfo","1.3.6.1.5.5.7.10.2":"accessIdentity","1.3.6.1.5.5.7.10.3":"chargingIdentity","1.3.6.1.5.5.7.10.4":"group","1.3.6.1.5.5.7.10.6":"encAttrs","1.3.6.1.5.5.7.12.2":"PKIData","1.3.6.1.5.5.7.12.3":"PKIResponse","1.3.6.1.5.5.7.48.1.1":"ocsp-basic","1.3.6.1.5.5.7.48.1.2":"ocsp-nonce","1.3.6.1.5.5.7.48.1.3":"ocsp-crl",
"1.3.6.1.5.5.7.48.1.4":"ocsp-response","1.3.6.1.5.5.7.48.1.5":"ocsp-nocheck","1.3.6.1.5.5.7.48.1.6":"ocsp-archive-cutoff","1.3.6.1.5.5.7.48.1.7":"ocsp-service-locator","2.16.840.1.101.2.1.2.78.2":"encryptedKeyPkg","2.16.840.1.101.2.1.2.78.3":"keyPackageReceipt","2.16.840.1.101.2.1.2.78.5":"aKeyPackage","2.16.840.1.101.2.1.2.78.6":"keyPackageError","2.16.840.1.101.3.4":"nistAlgorithms","2.16.840.1.101.3.4.1":"aes","2.16.840.1.101.3.4.1.1":"aes128-ECB","2.16.840.1.101.3.4.1.2":"aes128-CBC","2.16.840.1.101.3.4.1.3":"aes128-OFB",
"2.16.840.1.101.3.4.1.4":"aes128-CFB","2.16.840.1.101.3.4.1.5":"aes128-wrap","2.16.840.1.101.3.4.1.6":"aes128-GCM","2.16.840.1.101.3.4.1.7":"aes128-CCM","2.16.840.1.101.3.4.1.8":"aes128-wrap-pad","2.16.840.1.101.3.4.1.21":"aes192-ECB","2.16.840.1.101.3.4.1.22":"aes192-CBC","2.16.840.1.101.3.4.1.23":"aes192-OFB","2.16.840.1.101.3.4.1.24":"aes192-CFB","2.16.840.1.101.3.4.1.25":"aes192-wrap","2.16.840.1.101.3.4.1.26":"aes192-GCM","2.16.840.1.101.3.4.1.27":"aes192-CCM","2.16.840.1.101.3.4.1.28":"aes192-wrap-pad",
"2.16.840.1.101.3.4.1.41":"aes256-ECB","2.16.840.1.101.3.4.1.42":"aes256-CBC","2.16.840.1.101.3.4.1.43":"aes256-OFB","2.16.840.1.101.3.4.1.44":"aes256-CFB","2.16.840.1.101.3.4.1.45":"aes256-wrap","2.16.840.1.101.3.4.1.46":"aes256-GCM","2.16.840.1.101.3.4.1.47":"aes256-CCM","2.16.840.1.101.3.4.1.48":"aes256-wrap-pad","2.16.840.1.101.3.4.2.1":"sha256","2.16.840.1.101.3.4.2.2":"sha384","2.16.840.1.101.3.4.2.3":"sha512","2.16.840.1.113730.3.1.216":"userPKCS12","2.5.1.5.55":"clearance","2.5.4.0":"objectClass",
"2.5.4.1":"aliasedEntryName","2.5.4.2":"knowldgeinformation","2.5.4.3":"commonName","2.5.4.5":"serialName","2.5.4.6":"countryName","2.5.4.7":"localityName","2.5.4.8":"stateOrProvinceName","2.5.4.9":"streetAddress","2.5.4.10":"organizationName","2.5.4.11":"organizationalUnitName","2.5.4.12":"title","2.5.4.13":"description","2.5.4.14":"searchGuide","2.5.4.15":"businessCategory","2.5.4.16":"postalAddress","2.5.4.17":"postalCode","2.5.4.18":"postOfficeBox","2.5.4.19":"physicalDeliveryOfficeName","2.5.4.20":"telephoneNumber",
"2.5.4.21":"telexNumber","2.5.4.22":"teletexTerminalIdentifier","2.5.4.23":"facsimileTelephoneNumber","2.5.4.24":"x121Address","2.5.4.25":"internationalISDNNumber","2.5.4.26":"registeredAddress","2.5.4.27":"destinationIndicator","2.5.4.28":"preferredDeliveryMethod","2.5.4.29":"presentationAddress","2.5.4.30":"supportedApplicationContext","2.5.4.31":"member","2.5.4.32":"owner","2.5.4.33":"roleOccupant","2.5.4.34":"seeAlso","2.5.4.35":"userPassword","2.5.4.36":"userCertificate","2.5.4.37":"cACertificate",
"2.5.4.38":"authorityRevocationList","2.5.4.39":"certificateRevocationList","2.5.4.40":"crossCertificatePair","2.5.4.41":"name","2.5.4.42":"givenName","2.5.4.43":"initials","2.5.4.44":"generationQualifier","2.5.4.45":"uniqueIdentifier","2.5.4.46":"dnQualifier","2.5.4.47":"enhancedSearchGuide","2.5.4.48":"protocolInformation","2.5.4.49":"distinguishedName","2.5.4.50":"uniqueMember","2.5.4.51":"houseIdentifier","2.5.4.52":"supportedAlgorithms","2.5.4.53":"deltaRevocationList","2.5.4.58":"attributeCertificate",
"2.5.4.65":"pseudonym","2.5.4.72":"role","2.5.29.1":"authorityKeyIdentifier","2.5.29.2":"keyAttributes","2.5.29.3":"certificatePolicies","2.5.29.4":"keyUsageRestriction","2.5.29.5":"policyMapping","2.5.29.6":"subtreesConstraint","2.5.29.7":"subjectAltName","2.5.29.8":"issuerAltName","2.5.29.9":"subjectDirectoryAttributes","2.5.29.10":"basicConstraints","2.5.29.11":"nameConstraints","2.5.29.12":"policyConstraints","2.5.29.13":"basicConstraints","2.5.29.14":"subjectKeyIdentifier","2.5.29.15":"keyUsage",
"2.5.29.16":"privateKeyUsagePeriod","2.5.29.17":"subjectAltName","2.5.29.18":"issuerAltName","2.5.29.19":"basicConstraints","2.5.29.20":"cRLNumber","2.5.29.21":"cRLReason","2.5.29.22":"expirationDate","2.5.29.23":"instructionCode","2.5.29.24":"invalidityDate","2.5.29.25":"cRLDistributionPoints","2.5.29.26":"issuingDistributionPoint","2.5.29.27":"deltaCRLIndicator","2.5.29.28":"issuingDistributionPoint","2.5.29.29":"certificateIssuer","2.5.29.30":"nameConstraints","2.5.29.31":"cRLDistributionPoints",
"2.5.29.32":"certificatePolicies","2.5.29.33":"policyMappings","2.5.29.34":"policyConstraints","2.5.29.35":"authorityKeyIdentifier","2.5.29.36":"policyConstraints","2.5.29.37":"extKeyUsage","2.5.29.46":"freshestCRL","2.5.29.54":"inhibitAnyPolicy","2.5.29.55":"targetInformation","2.5.29.56":"noRevAvail"},g={},d;for(d in c)g[c[d]]=d;var a={"id-GostR3411-94-with-GostR3410-2001":"GOST R 34.10-2001/GOST R 34.11-94","id-GostR3411-94-with-GostR3410-94":"GOST R 34.10-94/GOST R 34.11-94","id-GostR3411-94":"GOST R 34.11-94",
"id-HMACGostR3411-94":"GOST R 34.11-94-HMAC","id-Gost28147-89-None-KeyWrap":"GOST 28147-89-KW","id-Gost28147-89-CryptoPro-KeyWrap":"GOST 28147-89-CPKW","id-GostR3410-2001":"GOST R 34.10-2001","id-GostR3410-94":"GOST R 34.10-94","id-GostR3410-94-a":"GOST R 34.10-94","id-GostR3410-94-aBis":"GOST R 34.10-94","id-GostR3410-94-b":"GOST R 34.10-94","id-GostR3410-94-bBis":"GOST R 34.10-94","id-Gost28147-89":"GOST 28147-89","id-Gost28147-89-MAC":"GOST 28147-89-MAC","id-GostR3410-2001-CryptoPro-ESDH":"GOST R 34.10-2001-DH/GOST R 34.11-94",
"id-GostR3410-94-CryptoPro-ESDH":"GOST R 34.10-94-DH/GOST R 34.11-94","id-GostR3410-2001DH":"GOST R 34.10-2001-DH","id-GostR3410-94DH":"GOST R 34.10-94-DH","id-tc26-gost3410-12-256":"GOST R 34.10-256","id-tc26-gost3410-12-512":"GOST R 34.10-512","id-tc26-gost3411-94":"GOST R 34.11-94","id-tc26-gost3411-12-256":"GOST R 34.11-256","id-tc26-gost3411-12-512":"GOST R 34.11-512","id-tc26-signwithdigest-gost3410-12-94":"GOST R 34.10-256/GOST R 34.11-94","id-tc26-signwithdigest-gost3410-12-256":"GOST R 34.10-256/GOST R 34.11-256",
"id-tc26-signwithdigest-gost3410-12-512":"GOST R 34.10-512/GOST R 34.11-512","id-tc26-hmac-gost-3411-12-256":"GOST R 34.11-256-HMAC","id-tc26-hmac-gost-3411-12-512":"GOST R 34.11-512-HMAC","id-tc26-agreement-gost-3410-12-256":"GOST R 34.10-256-DH/GOST R 34.11-256","id-tc26-agreement-gost-3410-12-512":"GOST R 34.10-512-DH/GOST R 34.11-512","id-sc-gost28147-ecb":"GOST 28147-89-ECB/SC","id-sc-gost28147-gamma":"GOST 28147-89-CTR/SC","id-sc-gost28147-gfb":"GOST 28147-89-CFB/SC","id-sc-gost28147-mac":"GOST 28147-89-MAC/SC",
"id-sc-gostR3410-94":"GOST R 34.10-94/SC","id-sc-gostR3410-94-default":"GOST R 34.10-94/SC","id-sc-gostR3410-94-test":"GOST R 34.10-94/SC/S-TEST","id-sc-gostR3411-94":"GOST R 34.11-94/SC","id-sc-gostR3411-94-with-gostR3410-94":"GOST R 34.10-94/GOST R 34.11-94/SC","id-sc-gostR3411-94-with-gostR3410-2001":"GOST R 34.10-2001/GOST R 34.11-94/SC","id-sc-cmsGostWrap":"GOST 28147-89-SCKW/SC","id-sc-cmsGost28147Wrap":"GOST 28147-89-KW/SC","id-sc-pbeWithGost3411AndGost28147":{derivation:{name:"GOST R 34.11-94-PBKDF2/SC"},
encryption:{name:"GOST 28147-ECB/SC"}},"id-sc-pbeWithGost3411AndGost28147CFB":{derivation:{name:"GOST R 34.11-94-PBKDF2/SC"},encryption:{name:"GOST 28147-CFB/SC"}},"id-sc-gostR3410-2001":"GOST R 34.10-2001/SC","id-sc-hmacWithGostR3411":"GOST R 34.11-94-HMAC/SC","id-sc-r3410-ESDH-r3411kdf":"GOST R 34.10-2001/GOST R 34.11-94/SC","id-sc-ecdh-singlePass-cofactor-r3411kdf":"GOST R 34.10-2001-SINGLEPASS/GOST R 34.11-94-KDF/SC",rsaEncryption:"RSASSA-PKCS1-v1_5",sha1withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",
hash:{name:"sha-1"}},sha256withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"sha-256"}},sha384withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"sha-384"}},sha512withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"sha-512"}},"rsaes-oaep":"RSA-OAEP","rsassa-pss":"RSA-PSS",ecdsa:"ECDSA","ecdsa-with-SHA1":{name:"ECDSA",hash:{name:"sha-1"}},"ecdsa-with-SHA256":{name:"ECDSA",hash:{name:"sha-256"}},"ecdsa-with-SHA384":{name:"ECDSA",hash:{name:"sha-384"}},"ecdsa-with-SHA512":{name:"ECDSA",
hash:{name:"sha-512"}},"pbeWithSHAAndAES128-CBC":{derivation:{name:"PBKDF2",hash:{name:"sha-1"}},encryption:{name:"AES-CBC",length:128}},"pbeWithSHAAndAES192-CBC":{derivation:{name:"PBKDF2",hash:{name:"sha-1"}},encryption:{name:"AES-CBC",length:192}},"pbeWithSHAAndAES256-CBC":{derivation:{name:"PBKDF2",hash:{name:"sha-1"}},encryption:{name:"AES-CBC",length:256}},"pbeWithSHA256AndAES128-CBC":{derivation:{name:"PBKDF2",hash:{name:"sha-256"}},encryption:{name:"AES-CBC",length:128}},"pbeWithSHA256AndAES192-CBC":{derivation:{name:"PBKDF2",
hash:{name:"sha-256"}},encryption:{name:"AES-CBC",length:192}},"pbeWithSHA256AndAES256-CBC":{derivation:{name:"PBKDF2",hash:{name:"sha-256"}},encryption:{name:"AES-CBC",length:256}},ecDH:"ECDH",dhKeyAgreement:"DH","aes128-CBC":{name:"AES-CBC",length:128},"aes128-CFB":{name:"AES-CFB",length:128},"aes128-GCM":{name:"AES-GCM",length:128},"aes128-wrap":{name:"AES-KW",length:128},"aes192-CBC":{name:"AES-CBC",length:192},"aes192-CFB":{name:"AES-CFB",length:192},"aes192-GCM":{name:"AES-GCM",length:192},
"aes192-wrap":{name:"AES-KW",length:192},"aes256-CBC":{name:"AES-CBC",length:256},"aes256-CFB":{name:"AES-CFB",length:256},"aes256-GCM":{name:"AES-GCM",length:256},"aes256-wrap":{name:"AES-KW",length:256},sha1:"sha-1",sha256:"sha-256",sha384:"sha-384",sha512:"sha-512",PBKDF2:"PBKDF2",PBES2:{derivation:{name:"PBKDF2"},encryption:{}},PBMAC1:{derivation:{name:"PBKDF2"},hmac:{}},hmacWithSHA1:{name:"HMAC",hash:{name:"sha-1"}},hmacWithSHA256:{name:"HMAC",hash:{name:"sha-256"}},hmacWithSHA384:{name:"HMAC",
hash:{name:"sha-384"}},hmacWithSHA512:{name:"HMAC",hash:{name:"sha-512"}}};for(d in a){var f=a[d];"string"===typeof f&&(f={name:f});f.id=d;a[d]=f}var b={"CP-94":{signature:a["id-GostR3411-94-with-GostR3410-94"],generation:{id:"id-GostR3410-94",name:"GOST R 34.10-94",namedParam:"X-A"},digest:a["id-GostR3411-94"],wrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:a["id-HMACGostR3411-94"],agreement:a["id-GostR3410-94-CryptoPro-ESDH"],encryption:{id:"id-Gost28147-89",
name:"GOST 28147-89",block:"CFB",sBox:"E-A",keyMeshing:"CP"},derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2",iterations:2E3}},"CP-01":{signature:a["id-GostR3411-94-with-GostR3410-2001"],generation:{id:"id-GostR3410-2001",name:"GOST R 34.10-2001",namedCurve:"X-256-A"},digest:{id:"id-GostR3411-94",name:"GOST R 34.11-94",sBox:"D-A"},wrapping:{id:"id-Gost28147-89-None-KeyWrap",name:"GOST 28147-89-KW",sBox:"E-A"},transwrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},
hmac:a["id-HMACGostR3411-94"],agreement:a["id-GostR3410-2001-CryptoPro-ESDH"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89-CFB-CPKM",sBox:"E-A"},derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2",iterations:2E3}},"TC-256":{signature:a["id-tc26-signwithdigest-gost3410-12-256"],generation:{id:"id-tc26-gost3410-12-256",name:"GOST R 34.10-2012",namedCurve:"X-256-A"},digest:a["id-tc26-gost3411-12-256"],wrapping:{id:"id-Gost28147-89-None-KeyWrap",name:"GOST 28147-89-KW",sBox:"E-A"},transwrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",
name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:a["id-tc26-hmac-gost-3411-12-256"],agreement:a["id-tc26-agreement-gost-3410-12-256"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89-CFB-CPKM",sBox:"E-A"},derivation:{id:"PBKDF2",name:"GOST R 34.11-256-12-PBKDF2",iterations:2E3}},"TC-512":{signature:a["id-tc26-signwithdigest-gost3410-12-512"],generation:{id:"id-tc26-gost3410-12-512",name:"GOST R 34.10-2012-512",namedCurve:"T-512-A"},digest:a["id-tc26-gost3411-12-512"],wrapping:{id:"id-Gost28147-89-None-KeyWrap",
name:"GOST 28147-89-KW",sBox:"E-A"},transwrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:a["id-tc26-hmac-gost-3411-12-512"],agreement:a["id-tc26-agreement-gost-3410-12-512"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89-CFB-CPKM",sBox:"E-A"},derivation:{id:"PBKDF2",name:"GOST R 34.11-512-PBKDF2",iterations:2E3}},"SC-94":{signature:a["id-sc-gostR3411-94-with-gostR3410-94"],generation:{id:"id-sc-gostR3410-94",name:"GOST R 34.10-94",namedParam:"S-A"},
digest:a["id-sc-gostR3411-94"],encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-89-CFB/SC",iv:new Uint8Array([0,0,0,0,0,0,0,0])},hmac:a["id-sc-hmacWithGostR3411"],wrapping:["id-sc-cmsGostWrap"],agreement:a["id-sc-r3410-ESDH-r3411kdf"],derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2",iterations:2048},pbes:{id:"id-sc-pbeWithGost3411AndGost28147CFB",derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/SC",iterations:2048},encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-CFB/SC",iv:new Uint8Array([0,
0,0,0,0,0,0,0])}}},"SC-01":{signature:a["id-sc-gostR3411-94-with-gostR3410-2001"],generation:{id:"id-sc-gostR3410-2001",name:"GOST R 34.10-2001/SC",namedCurve:"P-256"},digest:a["id-sc-gostR3411-94"],encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-89-CFB/SC",iv:new Uint8Array([0,0,0,0,0,0,0,0])},hmac:a["id-sc-hmacWithGostR3411"],wrapping:a["id-sc-cmsGostWrap"],agreement:a["id-sc-r3410-ESDH-r3411kdf"],derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/SC",iterations:2048},pbes:{id:"id-sc-pbeWithGost3411AndGost28147CFB",
derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/SC",iterations:2048},encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-CFB/SC",iv:new Uint8Array([0,0,0,0,0,0,0,0])}}},"RSA-1024":{signature:a.sha1withRSAEncryption,generation:{id:"rsaEncryption",name:"RSASSA-PKCS1-v1_5",modulusLength:1024,publicExponent:new Uint8Array([1,0,1])},digest:a.sha1,encryption:a["aes128-CFB"],hmac:a.hmacWithSHA1},"RSA-2048":{signature:a.sha256withRSAEncryption,generation:{id:"rsaEncryption",name:"RSASSA-PKCS1-v1_5",
modulusLength:2048,publicExponent:new Uint8Array([1,0,1])},digest:a.sha256,encryption:a["aes256-CFB"],hmac:a.hmacWithSHA256},"RSA-4096":{signature:a.sha512withRSAEncryption,generation:{id:"rsaEncryption",name:"RSASSA-PKCS1-v1_5",modulusLength:4096,publicExponent:new Uint8Array([1,0,1])},digest:a.sha512,encryption:a["aes256-CFB"],hmac:a.hmacWithSHA512},"ECDSA-256":{signature:a["ecdsa-with-SHA256"],generation:{id:"ecdsa",name:"ECDSA",namedCurve:"P-256"},digest:a.sha256,encryption:a["aes256-CFB"],hmac:a.hmacWithSHA256,
agreement:a.ecDH},"ECDSA-384":{signature:a["ecdsa-with-SHA384"],generation:{id:"ecdsa",name:"ECDSA",namedCurve:"P-384"},digest:a.sha384,encryption:a["aes256-CFB"],hmac:a.hmacWithSHA384,agreement:a.ecDH},"ECDSA-521":{signature:a["ecdsa-with-SHA512"],generation:{id:"ecdsa",name:"ECDSA",namedCurve:"P-521"},digest:a.sha512,encryption:a["aes256-CFB"],hmac:a.hmacWithSHA512,agreement:a.ecDH}};"CP-94 CP-01 TC-256 TC-512 SC-94 SC-01".split(" ").forEach(function(a){a=b[a];a.hmac.hash=a.digest;a.derivation.hash=
a.digest;a.derivation.hmac=a.hmac;a.pbes=a.pbes||{id:"PBES2",derivation:a.derivation,encryption:a.encryption};a.pbmac=a.pbmac||{id:"PBMAC1",derivation:a.derivation,hmac:a.hmac}});"RSA-1024 RSA-2048 RSA-4096 ECDSA-256 ECDSA-384 ECDSA-521".split(" ").forEach(function(a){a=b[a];a.derivation=a.derivation||{id:"PBKDF2",name:"PBKDF2",iterations:2048,hash:a.digest};a.pbes=a.pbes||{id:"PBES2",derivation:a.derivation,encryption:a.encryption};a.pbmac=a.pbmac||{id:"PBMAC1",derivation:a.derivation,hmac:a.hmac}});
e.crypto&&e.crypto.subtle&&setTimeout(function(){e.crypto.subtle.generateKey(b["RSA-2048"].generation)["catch"](function(){b["RSA-1024"].generation.hash=b["RSA-1024"].digest;b["RSA-2048"].generation.hash=b["RSA-2048"].digest;b["RSA-4096"].generation.hash=b["RSA-4096"].digest;a.rsaEncryption.hash=b["RSA-2048"].digest})});return{names:c,identifiers:g,algorithms:a,parameters:{"id-GostR3410-94-TestParamSet":{namedParam:"S-TEST"},"id-GostR3410-94-CryptoPro-A-ParamSet":{namedParam:"S-A"},"id-GostR3410-94-CryptoPro-B-ParamSet":{namedParam:"S-B"},
"id-GostR3410-94-CryptoPro-C-ParamSet":{namedParam:"S-C"},"id-GostR3410-94-CryptoPro-D-ParamSet":{namedParam:"S-D"},"id-GostR3410-94-CryptoPro-XchA-ParamSet":{namedParam:"X-A"},"id-GostR3410-94-CryptoPro-XchB-ParamSet":{namedParam:"X-B"},"id-GostR3410-94-CryptoPro-XchC-ParamSet":{namedParam:"X-C"},"id-GostR3410-2001-CryptoPro-TestParamSet":{namedCurve:"S-256-TEST"},"id-GostR3410-2001-CryptoPro-A-ParamSet":{namedCurve:"S-256-A"},"id-GostR3410-2001-CryptoPro-B-ParamSet":{namedCurve:"S-256-B"},"id-GostR3410-2001-CryptoPro-C-ParamSet":{namedCurve:"S-256-C"},
"id-GostR3410-2001-CryptoPro-XchA-ParamSet":{namedCurve:"X-256-A"},"id-GostR3410-2001-CryptoPro-XchB-ParamSet":{namedCurve:"X-256-B"},"id-tc26-gost-3410-12-256-paramSetTest":{namedCurve:"T-256-TEST"},"id-tc26-gost-3410-12-256-paramSetA":{namedCurve:"T-256-A"},"id-tc26-gost-3410-12-256-paramSetB":{namedCurve:"T-256-B"},"id-tc26-gost-3410-12-512-paramSetTest":{namedCurve:"T-512-TEST"},"id-tc26-gost-3410-12-512-paramSetA":{namedCurve:"T-512-A"},"id-tc26-gost-3410-12-512-paramSetB":{namedCurve:"T-512-B"},
"id-tc26-gost-3410-12-512-paramSetC":{namedCurve:"T-512-C"},"id-tc26-gost-3410-12-512-paramSetD":{namedCurve:"T-512-D"},secp256r1:{namedCurve:"P-256"},secp384r:{namedCurve:"P-384"},secp521r:{namedCurve:"P-521"},"id-GostR3411-94-TestParamSet":{sBox:"D-TEST"},"id-GostR3411-94-CryptoProParamSet":{sBox:"D-A"},"id-GostR3411-94-CryptoPro-A-ParamSet":{sBox:"D-B"},"id-GostR3411-94-CryptoPro-B-ParamSet":{sBox:"D-C"},"id-GostR3411-94-CryptoPro-C-ParamSet":{sBox:"D-D"},"id-Gost28147-89-TestParamSet":{block:"CTR",
sBox:"E-TEST"},"id-Gost28147-89-CryptoPro-A-ParamSet":{block:"CFB",sBox:"E-A",keyMeshing:"CP"},"id-Gost28147-89-CryptoPro-B-ParamSet":{block:"CFB",sBox:"E-B",keyMeshing:"CP"},"id-Gost28147-89-CryptoPro-C-ParamSet":{block:"CFB",sBox:"E-C",keyMeshing:"CP"},"id-Gost28147-89-CryptoPro-D-ParamSet":{block:"CFB",sBox:"E-D",keyMeshing:"CP"},"id-Gost28147-89-None-KeyMeshing":{keyMeshing:"NO"},"id-Gost28147-89-CryptoPro-KeyMeshing":{keyMeshing:"CP"},"id-tc26-gost-28147-param-Z":{sBox:"E-Z"}},attributes:{sBox:{"D-TEST":"id-GostR3411-94-TestParamSet",
"D-A":"id-GostR3411-94-CryptoProParamSet","D-B":"id-GostR3411-94-CryptoPro-A-ParamSet","D-C":"id-GostR3411-94-CryptoPro-B-ParamSet","D-D":"id-GostR3411-94-CryptoPro-C-ParamSet","E-TEST":"id-Gost28147-89-TestParamSet","E-A":"id-Gost28147-89-CryptoPro-A-ParamSet","E-B":"id-Gost28147-89-CryptoPro-B-ParamSet","E-C":"id-Gost28147-89-CryptoPro-C-ParamSet","E-D":"id-Gost28147-89-CryptoPro-D-ParamSet","E-Z":"id-tc26-gost-28147-param-Z","D-256":"id-tc26-gost3411-12-256","D-512":"id-tc26-gost3411-12-512"},
namedParam:{"S-TEST":"id-GostR3410-94-TestParamSet","S-A":"id-GostR3410-94-CryptoPro-A-ParamSet","S-B":"id-GostR3410-94-CryptoPro-B-ParamSet","S-C":"id-GostR3410-94-CryptoPro-C-ParamSet","S-D":"id-GostR3410-94-CryptoPro-D-ParamSet","X-A":"id-GostR3410-94-CryptoPro-XchA-ParamSet","X-B":"id-GostR3410-94-CryptoPro-XchB-ParamSet","X-C":"id-GostR3410-94-CryptoPro-XchC-ParamSet"},namedCurve:{"S-256-TEST":"id-GostR3410-2001-CryptoPro-TestParamSet","S-256-A":"id-GostR3410-2001-CryptoPro-A-ParamSet","S-256-B":"id-GostR3410-2001-CryptoPro-B-ParamSet",
"S-256-C":"id-GostR3410-2001-CryptoPro-C-ParamSet","X-256-A":"id-GostR3410-2001-CryptoPro-XchA-ParamSet","X-256-B":"id-GostR3410-2001-CryptoPro-XchB-ParamSet","P-256":"secp256r1","T-256-TEST":"id-tc26-gost-3410-12-256-paramSetTest","T-256-A":"id-tc26-gost-3410-12-256-paramSetA","T-256-B":"id-tc26-gost-3410-12-256-paramSetB","T-512-TEST":"id-tc26-gost-3410-12-512-paramSetTest","T-512-A":"id-tc26-gost-3410-12-512-paramSetA","T-512-B":"id-tc26-gost-3410-12-512-paramSetB"}},providers:b}});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(u,t){"function"===typeof define&&define.amd?define(t):"object"===typeof exports?module.exports=t():u.gostCoding=t()})(this,function(){function u(c){if(c instanceof ArrayBuffer)return c;if(c&&c.buffer&&c.buffer instanceof ArrayBuffer)return 0===c.byteOffset&&c.byteLength===c.buffer.byteLength?c.buffer:(new Uint8Array(new Uint8Array(c,c.byteOffset,c.byteLength))).buffer;throw new (t.DataError||Error)("ArrayBuffer or TypedArray required");}var t=this,s={Base64:{decode:function(c){c=c.replace(/[^A-Za-z0-9\+\/]/g,
"");for(var p=c.length,q=3*p+1>>2,b=new Uint8Array(q),m,e=0,d=0,g=0;g<p;g++){m=g&3;var a=c.charCodeAt(g),a=64<a&&91>a?a-65:96<a&&123>a?a-71:47<a&&58>a?a+4:43===a?62:47===a?63:0,e=e|a<<18-6*m;if(3===m||1===p-g){for(m=0;3>m&&d<q;m++,d++)b[d]=e>>>(16>>>m&24)&255;e=0}}return b.buffer},encode:function(c){c=new Uint8Array(u(c));for(var p=2,q="",b=c.length,m=0,e=0;e<b;e++)if(p=e%3,0<e&&0===4*e/3%96&&(q+="\r\n"),m|=c[e]<<(16>>>p&24),2===p||1===b-e){for(var d=18;0<=d;d-=6)var g=m>>>d&63,g=26>g?g+65:52>g?g+
71:62>g?g-4:62===g?43:63===g?47:65,q=q+String.fromCharCode(g);m=0}return q.substr(0,q.length-2+p)+(2===p?"":1===p?"=":"==")}}};s.Chars=function(){var c={1026:128,1027:129,8218:130,1107:131,8222:132,8230:133,8224:134,8225:135,8364:136,8240:137,1033:138,8249:139,1034:140,1036:141,1035:142,1039:143,1106:144,8216:145,8217:146,8220:147,8221:148,8226:149,8211:150,8212:151,8482:153,1113:154,8250:155,1114:156,1116:157,1115:158,1119:159,160:160,1038:161,1118:162,1032:163,164:164,1168:165,166:166,167:167,1025:168,
169:169,1028:170,171:171,172:172,173:173,174:174,1031:175,176:176,177:177,1030:178,1110:179,1169:180,181:181,182:182,183:183,1105:184,8470:185,1108:186,187:187,1112:188,1029:189,1109:190,1111:191},p={},q;for(q in c)p[c[q]]=q;return{decode:function(b,m){m=(m||"win1251").toLowerCase().replace("-","");for(var e=[],d=0,g=b.length;d<g;d++){var a=b.charCodeAt(d);if("utf8"===m)128>a?e.push(a):(2048>a?e.push(192+(a>>>6)):(65536>a?e.push(224+(a>>>12)):(2097152>a?e.push(240+(a>>>18)):(67108864>a?e.push(248+
(a>>>24)):(e.push(252+(a>>>30)),e.push(128+(a>>>24&63))),e.push(128+(a>>>18&63))),e.push(128+(a>>>12&63))),e.push(128+(a>>>6&63))),e.push(128+(a&63)));else if("unicode"===m||"ucs2"===m||"utf16"===m)if(55296>a||57344<=a&&65536>=a)e.push(a>>>8),e.push(a&255);else{if(65536<=a&&1114112>a){var a=a-65536,f=((1047552&a)>>10)+55296,a=(1023&a)+56320;e.push(f>>>8);e.push(f&255);e.push(a>>>8);e.push(a&255)}}else"utf32"===m||"ucs4"===m?(e.push(a>>>24&255),e.push(a>>>16&255),e.push(a>>>8&255),e.push(a&255)):"win1251"===
m?(128<=a&&(a=1040<=a&&1104>a?a-848:c[a]||0),e.push(a)):e.push(a&255)}return(new Uint8Array(e)).buffer},encode:function(b,c){c=(c||"win1251").toLowerCase().replace("-","");for(var e=[],d=new Uint8Array(u(b)),g=0,a=d.length;g<a;g++){var f=d[g];if("utf8"===c)f=252<=f&&254>f&&g+5<a?1073741824*(f-252)+(d[++g]-128<<24)+(d[++g]-128<<18)+(d[++g]-128<<12)+(d[++g]-128<<6)+d[++g]-128:f>>248&&252>f&&g+4<a?(f-248<<24)+(d[++g]-128<<18)+(d[++g]-128<<12)+(d[++g]-128<<6)+d[++g]-128:f>>240&&248>f&&g+3<a?(f-240<<18)+
(d[++g]-128<<12)+(d[++g]-128<<6)+d[++g]-128:224<=f&&240>f&&g+2<a?(f-224<<12)+(d[++g]-128<<6)+d[++g]-128:192<=f&&224>f&&g+1<a?(f-192<<6)+d[++g]-128:f;else if("unicode"===c||"ucs2"===c||"utf16"===c){if(f=(f<<8)+d[++g],55296<=f&&57344>f)var k=f-55296<<10,f=d[++g],f=(f<<8)+d[++g],f=k+(f-56320)+65536}else"utf32"===c||"ucs4"===c?(f=(f<<8)+d[++g],f=(f<<8)+d[++g],f=(f<<8)+d[++g]):"win1251"===c&&128<=f&&(f=192<=f&&256>f?f+848:p[f]||0);e.push(String.fromCharCode(f))}return e.join("")}}}();s.Hex={decode:function(c,
p){c=c.replace(/[^A-fa-f0-9]/g,"");var q=Math.ceil(c.length/2),b=new Uint8Array(q);c=(0<c.length%2?"0":"")+c;if(p&&("string"!==typeof p||0>p.toLowerCase().indexOf("little")))for(var m=0;m<q;m++)b[m]=parseInt(c.substr(2*(q-m-1),2),16);else for(m=0;m<q;m++)b[m]=parseInt(c.substr(2*m,2),16);return b.buffer},encode:function(c,p){var q=[],b=new Uint8Array(u(c)),m=b.length;if(p&&("string"!==typeof p||0>p.toLowerCase().indexOf("little")))for(var e=0;e<m;e++){var d=m-e-1;q[d]=(0<d&&0===d%32?"\r\n":"")+("00"+
b[e].toString(16)).slice(-2)}else for(e=0;e<m;e++)q[e]=(0<e&&0===e%32?"\r\n":"")+("00"+b[e].toString(16)).slice(-2);return q.join("")}};s.Int16={decode:function(c){c=(c||"").replace(/[^\-A-fa-f0-9]/g,"");0===c.length&&(c="0");var p=!1;"-"===c.charAt(0)&&(p=!0,c=c.substring(1));for(;"0"===c.charAt(0)&&1<c.length;)c=c.substring(1);c=(0<c.length%2?"0":"")+c;if(!p&&!/^[0-7]/.test(c)||p&&!/^[0-7]|8[0]+$/.test(c))c="00"+c;for(var q=c.length/2,b=new Uint8Array(q),m=0,q=q-1;0<=q;--q){var e=parseInt(c.substr(2*
q,2),16);p&&0<e+m&&(e=256-e-m,m=1);b[q]=e}return b.buffer},encode:function(c){c=new Uint8Array(u(c));if(0===c.length)return"0x00";for(var p=[],q=127<c[0],b=0,m=c.length-1;0<=m;--m){var e=c[m];q&&0<e+b&&(e=256-e-b,b=1);p[m]=("00"+e.toString(16)).slice(-2)}for(p=p.join("");"0"===p.charAt(0);)p=p.substring(1);return(q?"-":"")+"0x"+p}};s.BER=function(){function c(b,m){"undefined"===typeof b||null===b?b=new String(""):"string"===typeof b?b=new String(b):"number"===typeof b?b=new Number(b):"boolean"===
typeof b&&(b=new Boolean(b));var e=b.tagClass=b.tagClass||0,d;0===e&&(d=b.tagNumber);if("undefined"===typeof d)if(b instanceof String)d=0===e?""===b.toString()?5:/^\-?0x[0-9a-fA-F]+$/.test(b)?2:/^(\d+\.)+\d+$/.test(b)?6:/^[01]+$/.test(b)?3:/^(true|false)$/.test(b)?1:/^[0-9a-fA-F]+$/.test(b)?4:19:/^[0-9a-fA-F]+$/.test(b)?4:19;else if(b instanceof Number)d=2;else if(b instanceof Date)d=24;else if(b instanceof Boolean)d=1;else if(b instanceof Array)d=16;else if(b instanceof ArrayBuffer||b.buffer instanceof
ArrayBuffer)d=4;else throw new (t.DataError||Error)("Unrecognized type for "+b);var g=b.tagConstructed;"undefined"===typeof g&&(g=b.tagConstructed=b instanceof Array);var a;if(b instanceof ArrayBuffer||b.buffer instanceof ArrayBuffer){if(a=new Uint8Array(u(b)),3===d){var f=new Uint8Array(u(a));a=new Uint8Array(f.length+1);a[0]=0;a.set(f,1)}}else if(g)if(b instanceof Array){a=0;for(var k=[],h=f=0,n=b.length;h<n;h++)k[h]=c(b[h],m),a+=k[h].length;g&&"CER"===m&&(k[n]=new Uint8Array(2),a+=2);a=new Uint8Array(a);
h=0;for(n=k.length;h<n;h++)a.set(k[h],f),f+=k[h].length}else throw new (t.DataError||Error)("Constracted block can't be primitive");else switch(d){case 1:a=new Uint8Array(1);a[0]="true"===b.toString()?1:0;break;case 2:case 10:a=s.Int16.decode(b instanceof Number?"0x"+b.toString(16):b.toString());break;case 3:if("string"===typeof b||b instanceof String)for(h=7-(b.length+7)%8,n=Math.ceil(b.length/8),a=new Uint8Array(n+1),a[0]=h,h=0;h<n;h++){for(k=f=0;8>k;k++)var l=8*h+k,f=(f<<1)+(l<b.length?"1"===b.charAt(l)?
1:0:0);a[h+1]=f}break;case 4:a=s.Hex.decode(b instanceof Number?b.toString(16):b);break;case 6:f=b.match(/\d+/g);a=[];for(h=1;h<f.length;h++){n=+f[h];l=[];1===h&&(n+=40*f[0]);do l.push(n&127),n>>>=7;while(n);for(k=l.length-1;0<=k;--k)a.push(l[k]+(0===k?0:128))}a=new Uint8Array(a);break;case 12:a=s.Chars.decode(b,"utf8");break;case 18:case 22:case 19:case 20:case 21:case 25:case 26:case 27:h=0;for(n=b.length;h<n;h++)255<b.charCodeAt(h)&&(d=12);a=12===d?s.Chars.decode(b,"utf8"):s.Chars.decode(b,"ascii");
break;case 23:case 24:a=new Date(b);a.setMinutes(a.getMinutes()+a.getTimezoneOffset());a=(23===d?a.getYear().toString().slice(-2):a.getFullYear().toString())+("00"+(a.getMonth()+1)).slice(-2)+("00"+a.getDate()).slice(-2)+("00"+a.getHours()).slice(-2)+("00"+a.getMinutes()).slice(-2)+("00"+a.getSeconds()).slice(-2)+"Z";a=s.Chars.decode(a,"ascii");break;case 28:a=s.Chars.decode(b,"utf32");break;case 30:a=s.Chars.decode(b,"utf16")}a||(a=new Uint8Array(0));a instanceof ArrayBuffer&&(a=new Uint8Array(a));
b.tagNumber=0===e?d:d=b.tagNumber||0;b.content=a;h=[];n=3===e?192:2===e?128:1===e?64:0;g&&(n|=32);if(31>d)h.push(n|d&31);else{n|=31;h.push(n);n=d;f=[];do f.push(n&127),n>>>=7;while(n);for(k=f.length-1;0<=k;--k)h.push(f[k]+(0===k?0:128))}if(g&&"CER"===m)h.push(128);else if(g=a.length,127<g){n=g;g=[];do g.push(n&255),n>>>=8;while(n);h.push(g.length+128);for(k=g.length-1;0<=k;--k)h.push(g[k])}else h.push(g);g=b.header=new Uint8Array(h);b.typeName=1===e?"Application_"+d:2===e?"["+d.toString()+"]":3===
e?"Private_"+d:q[d]||"Universal_"+d.toString();e=new Uint8Array(g.length+a.length);e.set(g,0);e.set(a,g.length);return e}function p(b,c){var e=c||0,d=b[e++],g=d>>6,a=0!==(d&32),f=d&31;if(31===f){f=0;do{if(9007199254740864<f)throw new (t.DataError||Error)("Convertor not supported tag number more then (2^53 - 1) at position "+c);d=b[e++];f=(f<<7)+(d&127)}while(d&128)}var d=b[e++],k=d&127;if(k!==d){if(6<k)throw new (t.DataError||Error)("Length over 48 bits not supported at position "+c);if(0===k)k=null;
else{for(var h=d=0;h<k;++h)d=(d<<8)+b[e++];k=d}}var n=e,h=null;if(a)if(h=[],null!==k){for(d=n+k;e<d;){var l=p(b,e);h.push(l);e+=l.header.length+l.content.length}if(e!==d)throw new (t.DataError||Error)("Content size is not correct for container starting at offset "+n);}else try{for(;;){l=p(b,e);e+=l.header.length+l.content.length;if(0===l.tagClass&&0===l.tagNumber)break;h.push(l)}k=e-n}catch(u){throw new (t.DataError||Error)("Exception "+u+" while decoding undefined length content at offset "+n);}l=
new String("");e=new Uint8Array(b.buffer,c,n-c);d=new Uint8Array(b.buffer,n,k);if(null===h){if(null===k)throw new (t.DataError||Error)("Invalid tag with undefined length at offset "+n);if(0===g)switch(f){case 1:l=new Boolean(0!==b[n]);break;case 2:case 10:if(6<k)l=new String(s.Int16.encode(d));else{var r=d[0];127<d[0]&&(r-=256);for(h=1;h<k;h++)r=256*r+d[h];l=new Number(r)}break;case 3:if(5<k)l=(new Uint8Array(d.subarray(1))).buffer;else{n=d[0];l=[];for(h=k-1;1<=h;--h){for(k=d[h];8>n;++n)l.push(k>>
n&1?"1":"0");n=0}l=new String(l.reverse().join(""))}break;case 4:l=(new Uint8Array(d)).buffer;break;case 6:for(var l="",v=0,w=0,h=0;h<k;++h)r=d[h],v=(v<<7)+(r&127),w+=7,r&128||(""===l?(r=80>v?40>v?0:1:2,l=r+"."+(v-40*r)):l+="."+v.toString(),w=v=0);if(0<w)throw new (t.DataError||Error)("Incompleted OID at offset "+n);l=new String(l);break;case 16:case 17:l=[];break;case 12:l=new String(s.Chars.encode(d,"utf8"));break;case 18:case 19:case 20:case 21:case 22:case 25:case 26:case 27:l=new String(s.Chars.encode(d,
"ascii"));break;case 28:l=new String(s.Chars.encode(d,"utf32"));break;case 30:l=new String(s.Chars.encode(d,"utf16"));break;case 23:case 24:k=23===f;l=s.Chars.encode(d,"ascii");r=(k?/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/:/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/).exec(l);if(!r)throw new (t.DataError||
Error)('Unrecognized time format "'+l+'" at offset '+n);k&&(r[1]=+r[1],r[1]+=70>r[1]?2E3:1900);l=new Date(r[1],+r[2]-1,+r[3],+(r[4]||0),+(r[5]||0),+(r[6]||0),+(r[7]||0));k=l.getTimezoneOffset();if(r[8]||23===f)"Z"!==r[8].toUpperCase()&&r[9]&&(k+=parseInt(r[9])),l.setMinutes(l.getMinutes()-k)}else l=(new Uint8Array(d)).buffer}else l=h;k=1===g?"Application_"+f:2===g?"["+f.toString()+"]":3===g?"Private_"+f:q[f]||"Universal_"+f.toString();l.tagConstructed=a;l.tagClass=g;l.tagNumber=f;l.header=e;l.content=
d;l.typeName=k;return l}var q={0:"EOC",1:"BOOLEAN",2:"INTEGER",3:"BIT STRING",4:"OCTET STRING",5:"NULL",6:"OBJECT IDENTIFIER",7:"ObjectDescriptor",8:"EXTERNAL",9:"REAL",10:"ENUMERATED",11:"EMBEDDED PDV",12:"UTF8String",16:"SEQUENCE",17:"SET",18:"NumericString",19:"PrintableString",20:"TeletexString",21:"VideotexString",22:"IA5String",23:"UTCTime",24:"GeneralizedTime",25:"GraphicString",26:"VisibleString",27:"GeneralString",28:"UniversalString",30:"BMPString"};return{encode:function(b,m){return c(b,
m).buffer},decode:function(b){return p(new Uint8Array(u(b)),0)}}}();s.PEM={encode:function(c,p){return(p?"-----BEGIN "+p.toUpperCase()+"-----\r\n":"")+s.Base64.encode(c instanceof ArrayBuffer?c:s.BER.encode(c))+(p?"\r\n-----END "+p.toUpperCase()+"-----":"")},decode:function(c,p,q){var b=/([A-Za-z0-9\+\/\s\=]+)/g.exec(c);b[1].length!==c.length&&(b=!1);!b&&p&&(b=(new RegExp("-----\\s?BEGIN "+p.toUpperCase()+"-----([A-Za-z0-9\\+\\/\\s\\=]+)-----\\s?END "+p.toUpperCase()+"-----","g")).exec(c));b||(b=
RegExp("-----\\s?BEGIN [A-Z0-9\\s]+-----([A-Za-z0-9\\+\\/\\s\\=]+)-----\\s?END [A-Z0-9\\s]+-----","g").exec(c));if(b)c=b[1];else throw new (t.DataError||Error)("Not valid PEM format");c=s.Base64.decode(c);q&&(c=s.BER.decode(c));return c}};return s});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(B,w){"function"===typeof define&&define.amd?define(["gostObject","gostCoding"],w):"object"===typeof exports?module.exports=w(require("gostObject"),require("gostCoding")):B.gostSyntax=w(B.gostObject,B.gostCoding)})(this,function(B,w){function E(a){return(B||(B=C.gostObject)).algorithms[a]}function Ea(a){return(B||(B=C.gostObject)).names[a]}function eb(a){return(B||(B=C.gostObject)).identifiers[a]}function ba(a){return(B||(B=C.gostObject)).attributes[a]}function ca(a){return(B||(B=C.gostObject)).parameters[a]}
function U(){return(w||(w=C.gostCoding)).BER}function x(){for(var a={},c=0,g=arguments.length;c<g;c++){var b=arguments[c];if("object"===typeof b)for(var d in b)a[d]=b[d]}return a}function V(a){a instanceof ArrayBuffer&&(a=new Uint8Array(a));for(var c=new Uint8Array(a.length),g=0,b=a.length;g<b;g++)c[b-g-1]=a[g];return c.buffer}function ec(a,c){return a.length>=c?a:Array(c-a.length+1).join("0")+a}function Fa(a){return 2>=a?a:4>=a?4:8>=a?8:16>=a?16:32>=a?32:64>=a?64:128>=a?128:256>=a?256:512>a?512:
1024>a?1024:void 0}function N(a,c,g,b){var d;if("undefined"===typeof a)throw new I("Invalid value");null===a?d=new String(""):"string"===typeof a||a instanceof String?d=new String(a.toString()):"number"===typeof a||a instanceof Number?d=new Number(a.toString()):"boolean"===typeof a||a instanceof Boolean?d=new Boolean(a?!0:!1):a instanceof Array?d=a.slice(0):a instanceof Date?d=new Date(a.getTime()):a instanceof ArrayBuffer?d=(new Uint8Array(new Uint8Array(a))).buffer:a.buffer instanceof ArrayBuffer&&
(d=(new Uint8Array(new Uint8Array(a.buffer,a.byteOffset,a.byteLength))).buffer);d.tagNumber="undefined"!==typeof c?c:5;d.tagClass="undefined"!==typeof g?g:0;d.tagConstructed="undefined"!==typeof b?b:!1;return d}function O(a,c,g,b){if("undefined"===typeof a)throw new I("Invalid value");g="undefined"!==typeof g?g:0;b="undefined"!==typeof b?b:!1;if(void 0!==a.tagClass&&(c!==a.tagNumber&&!(c instanceof Array&&0<=c.indexOf(a.tagNumber))||g!==a.tagClass||b!==a.tagConstructed))throw new I("Invalid format");
b=a;0===g&&5===c?b=null:a instanceof String?b=a.toString():a instanceof Number?b=parseFloat(a):a instanceof Boolean?b=a?!0:!1:a instanceof Array?(b=a.slice(0),b.buffer=a.buffer?a.buffer:(new Uint8Array(new Uint8Array(a.header.buffer,a.header.byteOffset,a.header.byteLength+a.content.byteLength))).buffer):a instanceof Date?b=new Date(a.getTime()):a instanceof ArrayBuffer?b=(new Uint8Array(new Uint8Array(a))).buffer:a.buffer instanceof ArrayBuffer&&(b=(new Uint8Array(new Uint8Array(a.buffer,a.byteOffset,
a.byteLength))).buffer);return b}var C=this,I=C.DataError||Error,fb=C.NotSupportedError||Error,P={encode:function(a,c){return"0x"+(w||(w=C.gostCoding)).Hex.encode(a,c)},decode:function(a,c,g){a=a.replace("0x","");g=g||Fa(a.length);return(w||(w=C.gostCoding)).Hex.decode(ec(a,g),c)}},Q=function(a){return{encode:function(c){return N(c,a)},decode:function(c){return O(c,a)}}},W=Q(1),Ga=Q(22),sa=Q(19),fc=Q(20),R=Q(12),gc=Q(23),J=Q(24),hc=Q(28),gb=Q(30),ma={encode:function(){return N(null,5)},decode:function(a){return O(a,
5)}},hb=function(a){var c=Q(a);a=function(a){return{encode:function(b){b=a[b];if("undefined"===typeof b)throw new I("Invalid value");return c.encode(b)},decode:function(b){b=c.decode(b);for(var d in a)if(b===a[d])return d}}};a.encode=c.encode;a.decode=c.decode;return a},h=hb(2),ib=hb(10),jb=function(a,c){var g=function(g){c&&c.call&&(g=c(g));return{encode:function(c){g&&(c=g.encode(c));return N(c,a)},decode:function(c){c=O(c,a);g&&(c=g.decode(c));return c}}};g.encode=function(c){return N(c,a)};g.decode=
function(c){return O(c,a)};return g},k=jb(4),q=jb(3,function(a){if(!a||a.encode&&a.decode)return a;var c=[],g;for(g in a)c[a[g]]=g;return{encode:function(a){if(a instanceof Array){for(var g="",b=0;b<c.length;b++)g=c[b]&&0<=a.indexOf(c[b])?g+"1":g+"0";for(;1<g.length&&"0"===g.charAt(g.length-1);)g=g.substring(0,g.length-1)}else g="0";return g},decode:function(a){for(var g=[],b=0;b<a.length;b++)"1"===a.charAt(b)&&c[b]&&g.push(c[b]);return g}}}),d=function(a){return{encode:function(c){var g=[],b;for(b in a){var d=
a[b].encode(c[b]);void 0!==d&&g.push(d)}return N(g,16,0,!0)},decode:function(c){c=O(c,16,0,!0);var g={},b=0,d;for(d in a){var e=a[d].decode(c[b]);void 0!==e&&(g[d]=e,b++)}g.buffer=c.buffer;return g}}},l={encode:function(a){if(!/^(\d+\.)+\d+$/.test(a)&&(a=eb(a),!a))throw new I("Invalid object identifier value");return N(a,6)},decode:function(a){a=O(a,6);return Ea(a)||a}},b=function(a,c){return{encode:function(g){g=c.encode(g);return N(g,a,2,g instanceof Array)},decode:function(g){return c.decode(O(g,
a,2,g instanceof Array))}}},kb=function(a){return function(c,g,b){c=c||y;var d=function(d,e){var f=c.call?c(d):c;return{encode:function(c){var b=[];if(g)for(var d in c)"buffer"!==d&&b.push(f.encode(g(d,c[d],e)));else{d=0;for(var h=c.length;d<h;d++)b.push(f.encode(c[d]))}return N(b,a,0,!0)},decode:function(c){var g=b?{}:[];c=O(c,a,0,!0);if(b)for(var d=0;d<c.length;d++)b(g,f.decode(c[d]));else for(var d=0,e=c.length;d<e;d++)g.push(f.decode(c[d]));g.buffer=c.buffer;return g}}};d.encode=function(g){for(var b=
[],d=0,e=g.length;d<e;d++)b.push(c.encode(g[d]));return N(b,a,0,!0)};d.decode=function(g){g=O(g,a,0,!0);for(var b=[],d=0,e=g.length;d<e;d++)b.push(c.decode(g[d]));b.buffer=g.buffer;return b};return d}},m=kb(16),D=kb(17),F=function(a){return{encode:function(c){return N([a.encode(c)],17,0,!0)},decode:function(c){c=O(c,17,0,!0);return a.decode(c[0])}}},p=function(a,c,g){return a instanceof Array?{encode:function(b){if(c){var d=c(b);if(void 0!==d&&0<=d&&d<a.length){var e=g?g.encode(b,d):b,f=a[d].encode(e);
if(void 0!==f)return f}}for(d=0;d<a.length;d++)try{if(e=g?g.encode(b,d):b,f=a[d].encode(e),void 0!==f)return f}catch(h){}throw new I("Invalid format");},decode:function(c){for(var b=0;b<a.length;b++)try{var d=a[b].decode(c);if(void 0!==d)return g?g.decode(d,b):d}catch(e){}throw new I("Invalid format");}}:{encode:function(c){for(var b in a){var g=c[b];if(void 0!==g)return a[b].encode(g)}throw new I("Invalid format");},decode:function(c){var b={},g;for(g in a)try{var d=a[g].decode(c);if(void 0!==d)return b[g]=
d,b}catch(e){}throw new I("Invalid format");}}},K=function(){var a=function(a){return{encode:function(b){b=a.encode(b);return U().encode(b)},decode:function(b){b=U().decode(b);return a.decode(b)}}};a.encode=function(a){return U().encode(a)};a.decode=function(a){return U().decode(a)};return a}(),f=function(a){return{encode:function(c){return a.encode(c)},decode:function(c){return a.decode(c)}}},t=function(a){return{encode:function(c){return[a.encode(c)]},decode:function(c){return a.decode(c[0])}}},
y={encode:function(a){return a},decode:function(a){return a}},L=function(a,c){return{encode:function(b){return b===c||void 0===b?void 0:a.encode(b)},decode:function(b){if(void 0===b)return c;try{return a.decode(b)}catch(d){}}}},e=function(a){return{encode:function(c){return void 0===c?void 0:a.encode(c)},decode:function(c){if(void 0!==c)try{return a.decode(c)}catch(b){}}}},lb=function(a,c,b){b=b||y;var d=function(d,e){d=d||{};e=e||b;var f=function(a){var c;d&&(c=d.call?d(a):d[a]);return c||e};return{encode:function(b){var d=
f(c.encode(b));return a(d).encode(b)},decode:function(b){var d=f(c.decode(b));return a(d).decode(b)}}};d.encode=function(c){return a(b).encode(c)};d.decode=function(c){return a(b).decode(c)};return d},X=function(a,c,b,e){c=c||"type";b=b||l;return lb(function(c){return d(a(c))},{encode:function(a){return a[c]},decode:function(a){return b.decode(a[0])}},e)},da=p([R,sa,fc,hc,gb],function(a){if(a&&1<a.length){var c=a.charCodeAt(a.length-1);if(5>c)return c}return/^[A-Za-z0-9\.@\+\-\:\=\\\/\?\!\#\$\%\^\&\*\(\)\[\]\{\}\>\<\|\~]*$/.test(a)?
1:0},{encode:function(a){return a.replace(/[\u0000-\u0004]/g,"")},decode:function(a,c){return a+String.fromCharCode(c)}}),Y=p([J,gc],function(a){return 2050<=a.getYear()?0:1}),Ha=y,Ia=X(function(a){return{type:l,value:a}},"type",l,Ha),mb=F(Ia({serialName:sa,countryName:sa,dnQualifier:sa,emailAddress:Ga,domainComponent:Ga},da)),ic=m(mb,function(a,c){return{type:a,value:c}},function(a,c){a[c.type]=c.value})(),S=p([ic]),jc=function(){var a={commonName:"CN",serialName:"SN",countryName:"C",localityName:"L",
stateOrProvinceName:"ST",streetAddress:"STREET",organizationName:"O",organizationalUnitName:"OU",title:"TITLE",name:"NAME",givenName:"GNAME",initials:"INITIALS",distinguishedName:"DN",emailAddress:"EMAIL"},c=[],b;for(b in a)c[a[b]]=b;return{encode:function(c){var b=[],d;for(d in c)"buffer"!==d&&b.push((a[d]||eb(d))+"="+c[d]);return b.join(",")},decode:function(a){a=a.split(",");for(var b=0,d=a.length;b<d;b++){var g=a[b].split("="),e=g[0].trim();g[1].trim();c[e]||Ea(e)}}}}(),kc=d({notBefore:Y,notAfter:Y}),
nb=X(function(a){return{type:l,value:a}}),G=D(nb,function(a,c){return{type:a,value:c}},function(a,c){a[c.type]=c.value}),Ja=m(nb,function(a,c){return{type:a,value:c}},function(a,c){a[c.type]=c.value}),lc=d({a:h,b:h,seed:e(q)}),mc=k({encode:function(a){var c=Math.max(Fa(a.x.length-2),Fa(a.y.length-2))/2,b=new Uint8Array(2*c+1);b[0]=4;b.set(new Uint8Array(P.decode(a.x,!1,c)),1);b.set(new Uint8Array(P.decode(a.y,!1,c)),c+1);return b.buffer},decode:function(a){var c=(a.length-1)/2;return{x:P.encode(new Uint8Array(a,
1,c)),y:P.encode(new Uint8Array(a,c+1,c))}}}),nc=d({fieldType:l,parameters:h}),oc=d({version:h,fieldID:nc,curve:lc,base:mc,order:h,cofactor:e(h)}),pc=d({publicKeyParamSet:l,digestParamSet:l,encryptionParamSet:L(l,"id-Gost28147-89-CryptoPro-A-ParamSet")}),qc=function(a,c){return{encode:function(b){return b===c||void 0===b?ma.encode(null):a.encode(b)},decode:function(b){return void 0===b?void 0:null===b?c:a.decode(b)}}}(l,"id-GostR3411-94-CryptoProParamSet"),rc=p({namedParameters:l,ecParameters:oc,
implicitly:e(ma)}),n=function(){var a=function(a){return d({algorithm:l,parameters:e(a)})},c=function(c){return{encode:function(b){var d=c[b.id];if(d)return a(d.paramType).encode(d.encode(b));throw new fb("Algorithm not supported");},decode:function(b){var d=c[Ea(b[0])];if(d)return d.decode(a(d.paramType).decode(b));throw new fb("Algorithm not supported");}}};c.encode=function(c){return a(y).encode(c)};c.decode=function(c){return a(y).decode(c)};return c}(),Z={paramType:rc,encode:function(a){var c;
c="string"===typeof a.namedCurve?{namedParameters:ba("namedCurve")[a.namedCurve]}:{ecParameters:{version:1,fieldID:{fieldType:"id-prime-Field",parameters:a.p},curve:{a:a.a,b:a.b},base:{x:a.x,y:a.y},order:a.q,cofactor:1}};return{algorithm:a.id,parameters:c}},decode:function(a){var c=a.parameters;a=E(a.algorithm);if(c.namedParameters)a=x(a,ca(c.namedParameters));else if(c.ecParameters)a=x(a,{p:c.ecParameters.fieldID.parameters,a:c.ecParameters.curve.a,b:c.ecParameters.curve.b,x:c.ecParameters.base.x,
y:c.ecParameters.base.y,q:c.ecParameters.order});else throw new I("Invalid key paramters");return a}},H={paramType:pc,encode:function(a){var c=a.namedCurve?"namedCurve":"namedParam",b=0<=a.name.indexOf("-94")||0<=a.name.indexOf("-2001")||1994===a.version||2001===a.version?a.sBox||"D-A":0<=a.name.indexOf("-512")||512===a.length?"D-512":"D-256";return{algorithm:a.id,parameters:{publicKeyParamSet:ba(c)[a[c]],digestParamSet:ba("sBox")[b]}}},decode:function(a){var c=a.parameters;return x(E(a.algorithm),
ca(c.publicKeyParamSet),ca(c.digestParamSet))}},r={encode:function(a){return{algorithm:a.id}},decode:function(a){return E(a.algorithm)}},u={paramType:ma,encode:function(a){return{algorithm:a.id,parameters:null}},decode:function(a){return E(a.algorithm)}},ob={paramType:qc,encode:function(a){return{algorithm:a.id,parameters:ba("sBox")[a.sBox||"D-A"]}},decode:function(a){return x(E(a.algorithm),ca(a.parameters))}},ta=n({ecdsa:Z,rsaEncryption:u,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":H,"id-GostR3410-94":H,
"id-tc26-gost3410-12-256":H,"id-tc26-gost3410-12-512":H}),M=n({noSignature:u,rsaEncryption:u,sha1withRSAEncryption:u,sha256withRSAEncryption:u,sha384withRSAEncryption:u,sha512withRSAEncryption:u,ecdsa:r,"ecdsa-with-SHA1":r,"ecdsa-with-SHA256":r,"ecdsa-with-SHA384":r,"ecdsa-with-SHA512":r,"id-GostR3410-94":u,"id-GostR3410-2001":u,"id-GostR3411-94-with-GostR3410-2001":r,"id-GostR3411-94-with-GostR3410-94":r,"id-tc26-gost3410-12-256":u,"id-tc26-gost3410-12-512":u,"id-tc26-signwithdigest-gost3410-12-94":r,
"id-tc26-signwithdigest-gost3410-12-256":r,"id-tc26-signwithdigest-gost3410-12-512":r,"id-sc-gostR3410-94":u,"id-sc-gostR3410-2001":u,"id-sc-gostR3411-94-with-gostR3410-94":u,"id-sc-gostR3411-94-with-gostR3410-2001":u}),ea=n({sha1:u,sha256:u,sha384:u,sha512:u,"id-GostR3411-94":ob,"id-tc26-gost3411-94":ob,"id-tc26-gost3411-12-256":u,"id-tc26-gost3411-12-512":u,"id-sc-gostR3411-94":r}),pb=d({iv:k,encryptionParamSet:l}),sc=d({encryptionParamSet:l,ukm:e(k)}),Ka={paramType:pb,encode:function(a){return{algorithm:a.id,
parameters:{iv:a.iv,encryptionParamSet:ba("sBox")[a.sBox||"E-A"]}}},decode:function(a){var c=x(E(a.algorithm),ca(a.parameters.encryptionParamSet));c.iv=a.parameters.iv;return c}},La={paramType:k,encode:function(a){return{algorithm:a.id,parameters:a.iv}},decode:function(a){var c=x(E(a.algorithm));c.iv=a.parameters||new Uint8Array([0,0,0,0,0,0,0,0]);return c}},fa={paramType:sc,encode:function(a){return{algorithm:a.id,parameters:{encryptionParamSet:ba("sBox")[a.sBox||"E-A"],ukm:a.ukm}}},decode:function(a){var c=
x(E(a.algorithm),ca(a.parameters.encryptionParamSet));a.parameters.ukm&&(c.ukm=a.parameters.ukm);return c}},qb=n({"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa}),$={paramType:qb,encode:function(a){return{algorithm:a.id,parameters:a.wrapping}},decode:function(a){var c=x(E(a.algorithm));c.wrapping=a.parameters;return c}},ga=n({ecdsa:Z,rsaEncryption:u,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":H,"id-GostR3410-94":H,"id-tc26-gost3410-12-256":H,"id-tc26-gost3410-12-512":H,
"id-GostR3410-94-CryptoPro-ESDH":$,"id-GostR3410-2001-CryptoPro-ESDH":$,"id-tc26-agreement-gost-3410-12-256":$,"id-tc26-agreement-gost-3410-12-512":$,"id-sc-r3410-ESDH-r3411kdf":Z,"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa,"id-sc-cmsGostWrap":r,"id-sc-cmsGost28147Wrap":r}),tc=n({"id-sc-gost28147-gfb":La,"id-Gost28147-89":Ka}),Ma=n({"id-Gost28147-89-MAC":pb,"id-HMACGostR3411-94":r,"id-tc26-hmac-gost-3411-12-256":r,"id-tc26-hmac-gost-3411-12-512":r,hmacWithSHA1:r,hmacWithSHA224:r,
hmacWithSHA256:r,hmacWithSHA384:r,hmacWithSHA512:r,"id-sc-gost28147-mac":r,"id-sc-hmacWithGostR3411":r}),uc={paramType:d({salt:p({specified:k,otherSource:n}),iterationCount:h,keyLength:e(h),prf:Ma}),encode:function(a){return{algorithm:a.id,parameters:{salt:{specified:a.salt},iterationCount:a.iterations,prf:a.hmac}}},decode:function(a){var c=x(E(a.algorithm));c.salt=a.parameters.salt.specified;c.iterations=a.parameters.iterationCount;c.hmac=a.parameters.prf;return c}},Na=n({PBKDF2:uc}),s={paramType:d({salt:k,
iterationCount:h}),encode:function(a){return{algorithm:a.id,parameters:{salt:a.derivation.salt,iterationCount:a.derivation.iterations}}},decode:function(a){var c=x(E(a.algorithm));c.derivation=x(c.derivation,{salt:a.parameters.salt,iterations:a.parameters.iterationCount});return c}},Oa={paramType:d({keyDerivationFunc:Na,encryptionScheme:tc}),encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,encryptionScheme:a.encryption}}},decode:function(a){var c=x(E(a.algorithm));
c.derivation=a.parameters.keyDerivationFunc;c.encryption=a.parameters.encryptionScheme;return c}};n({"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:Oa});var vc={paramType:d({keyDerivationFunc:Na,messageAuthScheme:Ma}),encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,
messageAuthScheme:a.hmac}}},decode:function(a){var c=x(E(a.algorithm));c.derivation=a.parameters.keyDerivationFunc;c.hmac=a.parameters.messageAuthScheme;return c}};n({PBMAC1:vc});var wc=n({"id-sc-gost28147-gfb":La,"id-Gost28147-89":Ka,"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:Oa}),
ga=n({ecdsa:Z,rsaEncryption:u,"id-sc-gost28147-gfb":La,"id-Gost28147-89":Ka,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":H,"id-GostR3410-94":H,"id-tc26-gost3410-12-256":H,"id-tc26-gost3410-12-512":H,"id-GostR3410-94-CryptoPro-ESDH":$,"id-GostR3410-2001-CryptoPro-ESDH":$,"id-tc26-agreement-gost-3410-12-256":$,"id-tc26-agreement-gost-3410-12-512":$,"id-sc-r3410-ESDH-r3411kdf":Z,"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa,"id-sc-cmsGostWrap":r,"id-sc-cmsGost28147Wrap":r,
"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:Oa}),xc=k({encode:function(a){var c=new Uint8Array(a.byteLength+1),b=V(a);a=a.byteLength/2;c[0]=4;c.set(new Uint8Array(b,a,a),1);c.set(new Uint8Array(b,0,a),a+1);return c.buffer},decode:function(a){var c=new Uint8Array(a.byteLength-1),b=c.byteLength/
2;c.set(new Uint8Array(a,b+1,b),0);c.set(new Uint8Array(a,1,b),b);return V(c)}}),aa=d({algorithm:ta,subjectPublicKey:q}),Pa=function(a){return{encode:function(c){return aa.encode({algorithm:c.algorithm,subjectPublicKey:K.encode(a[c.algorithm.id].encode(c.buffer))})},decode:function(c){c=aa.decode(c);return{algorithm:c.algorithm,type:"public",extractable:!0,usages:["verify","deriveKey","deriveBits"],buffer:a[c.algorithm.id].decode(K.decode(c.subjectPublicKey))}}}}({"id-sc-gostR3410-2001":xc,"id-sc-gostR3410-94":{encode:function(a){return h.encode((w||
(w=C.gostCoding)).Int16.encode(V(a)))},decode:function(a){return V((w||(w=C.gostCoding)).Int16.decode(h.decode(a)))}},"id-GostR3410-2001":k,"id-GostR3410-94":k,"id-tc26-gost3410-12-256":k,"id-tc26-gost3410-12-512":k}),rb={encode:function(a){return K(h).encode(P.encode(a,!0))},decode:function(a){return P.decode(K(h).decode(a),!0)}},ua=y,na=d({version:h,privateKeyAlgorithm:ta,privateKey:k,attributes:e(b(0,f(G)))}),yc=d({version:h,privateKeyAlgorithm:ta,privateKey:k,attributes:e(b(0,f(G))),publicKey:e(b(1,
f(q)))}),zc=m(yc),Ac=function(a){return{encode:function(c){return na.encode({version:0,privateKeyAlgorithm:c.algorithm,privateKey:a[c.algorithm.id].encode(c.buffer)})},decode:function(c){c=na.decode(c);return{algorithm:c.privateKeyAlgorithm,type:"private",extractable:!0,usages:["sign","deriveKey","deriveBits"],buffer:a[c.privateKeyAlgorithm.id].decode(c.privateKey)}}}}({"id-sc-gostR3410-2001":rb,"id-sc-gostR3410-94":rb,"id-GostR3410-2001":ua,"id-GostR3410-94":ua,"id-tc26-gost3410-12-256":ua,"id-tc26-gost3410-12-512":ua}),
sb=d({encryptionAlgorithm:ga,encryptedData:k}),Bc=d({cA:L(W,!1),pathLenConstraint:e(h)}),Cc=q({digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8}),Dc=m(l),Ec=m({type:l,value:b(0,t(y))}),Fc=d({nameAssigner:e(b(0,f(da))),partyName:e(b(1,f(da)))}),Gc=d({}),z=p({otherName:b(0,f(Ec)),rfc822Name:b(1,f(da)),dNSName:b(2,f(da)),x400Address:b(3,f(Gc)),directoryName:b(4,t(S)),ediPartyName:b(5,f(Fc)),uniformResourceIdentifier:b(6,
f(da)),iPAddress:b(7,f(k)),registeredID:b(8,f(l))}),A=m(z),Qa=d({keyIdentifier:e(b(0,f(k))),authorityCertIssuer:e(b(1,f(A))),authorityCertSerialNumber:e(b(2,f(h)))}),Hc=d({notBefore:e(b(0,f(J))),notAfter:e(b(1,f(J)))}),Ic=d({policyQualifierId:l,qualifier:y}),Jc=d({policyIdentifier:l,policyQualifiers:e(m(Ic))}),Kc=d({issuerDomainPolicy:l,subjectDomainPolicy:l}),Lc=d({base:z,minimum:L(b(0,f(h)),0),maximum:e(b(1,f(h)))}),tb=m(Lc),Mc=d({permittedSubtrees:e(b(0,f(tb))),excludedSubtrees:e(b(1,f(tb)))}),
Nc=d({requireExplicitPolicy:e(b(0,f(h))),inhibitPolicyMapping:e(b(1,f(h)))}),Ra=q({unused:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,privilegeWithdrawn:7,aACompromise:8}),ub=p({fullName:b(0,f(A)),nameRelativeToCRLIssuer:b(1,f(mb))}),Oc=d({distributionPoint:e(b(0,t(ub))),reasons:e(b(1,f(Ra))),cRLIssuer:e(b(2,f(A)))}),va=m(Oc),Sa=d({accessMethod:l,accessLocation:z}),vb=X(function(a){return{extnID:l,critical:L(W,!1),extnValue:k(K(a))}},
"extnID"),oa=m(vb,function(a,c,b){return{extnID:a,critical:b&&b(a,c),extnValue:c}},function(a,c){return a[c.extnID]=c.extnValue}),wa=oa({authorityKeyIdentifier:Qa,subjectKeyIdentifier:k,keyUsage:Cc,privateKeyUsagePeriod:Hc,certificatePolicies:m(Jc),policyMappings:m(Kc),subjectAltName:A,issuerAltName:A,subjectDirectoryAttributes:Ja,basicConstraints:Bc,nameConstraints:Mc,policyConstraints:Nc,extKeyUsage:Dc,cRLDistributionPoints:va,inhibitAnyPolicy:h,freshestCRL:va,authorityInfoAccess:m(Sa),subjectInfoAccess:m(Sa)},
function(a,c){return"keyUsage"===a||"basicConstraints"===a&&void 0===c.pathLenConstraint}),xa=function(){var a=d({r:h,s:h});return{encode:function(c){c=V(c);var b=c.byteLength/2,d=P.encode(new Uint8Array(c,0,b));c=P.encode(new Uint8Array(c,b,b));return U().encode(a.encode({r:c,s:d}))},decode:function(c){var b=a.decode(U().decode(c));c=new Uint8Array(P.decode(b.r));var b=new Uint8Array(P.decode(b.s)),d=new Uint8Array(b.length+c.length);d.set(b,0);d.set(c,b.length);return V(d.buffer)}}}(),T={encode:function(a){return V(a)},
decode:function(a){return V(a)}},wb=function(a){return function(c){var b=a[c.id];return{encode:function(a){b&&(a=b.encode(a));return a},decode:function(a){if(a instanceof ArrayBuffer)return b&&(a=b.decode(a)),a;throw new I("Invalid signature value");}}}}({noSignature:k,"id-GostR3410-94":T,"id-GostR3410-2001":T,"id-GostR3411-94-with-GostR3410-2001":T,"id-GostR3411-94-with-GostR3410-94":T,"id-tc26-gost3410-12-256":T,"id-tc26-gost3410-12-512":T,"id-tc26-signwithdigest-gost3410-12-94":T,"id-tc26-signwithdigest-gost3410-12-256":T,
"id-tc26-signwithdigest-gost3410-12-512":T,"id-sc-gostR3410-94":xa,"id-sc-gostR3410-2001":xa,"id-sc-gostR3411-94-with-gostR3410-94":xa,"id-sc-gostR3411-94-with-gostR3410-2001":xa}),ha=function(a){return{encode:function(c){c=x(c);c.signatureValue=wb(c.signatureAlgorithm).encode(c.signatureValue);return a.encode(c)},decode:function(c){c=a.decode(c);c.signatureValue=wb(c.signatureAlgorithm).decode(c.signatureValue);return c}}},xb=d({version:b(0,t(h)),serialNumber:h,signature:M,issuer:S,validity:kc,subject:S,
subjectPublicKeyInfo:aa,issuerUniqueID:e(b(1,f(q))),subjectUniqueID:e(b(2,f(q))),extensions:e(b(3,t(wa)))}),ya=ha(d({tbsCertificate:xb,signatureAlgorithm:M,signatureValue:q})),Pc=G({challengePassword:F(da),extensionRequest:F(wa),msCertExtensions:F(wa),extendedCertificateAttributes:F(G)}),yb=d({version:h,subject:S,subjectPublicKeyInfo:aa,attributes:b(0,f(Pc))}),zb=ha(d({requestInfo:yb,signatureAlgorithm:M,signatureValue:q})),Ab=ib({unspecified:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,
superseded:4,cessationOfOperation:5,certificateHold:6,removeFromCRL:8,privilegeWithdrawn:9,aACompromise:10}),Qc=d({distributionPoint:e(b(0,t(ub))),onlyContainsUserCerts:L(b(1,f(W)),!1),onlyContainsCACerts:L(b(2,f(W)),!1),onlySomeReasons:e(b(3,f(Ra))),indirectCRL:L(b(4,f(W)),!1),onlyContainsAttributeCerts:L(b(5,f(W)),!1)}),Rc=oa({authorityKeyIdentifier:Qa,issuerAltName:A,cRLNumber:h,deltaCRLIndicator:h,issuingDistributionPoint:Qc,freshestCRL:va},function(a){return"cRLNumber"===a}),Sc=oa({cRLReason:Ab,
instructionCode:l,invalidityDate:J,certificateIssuer:A}),Bb=d({version:e(h),signature:M,issuer:S,thisUpdate:Y,nextUpdate:e(Y),revokedCertificates:e(m(d({userCertificate:h,revocationDate:Y,crlEntryExtensions:e(Sc)}))),crlExtensions:e(b(0,t(Rc)))}),Ta=ha(d({tbsCertList:Bb,signatureAlgorithm:M,signatureValue:q})),Ua=d({digestedObjectType:ib({publicKey:0,publicKeyCert:1,otherObjectTypes:2}),otherObjectTypeID:e(l),digestAlgorithm:ea,objectDigest:q}),za=d({issuer:A,serial:h,issuerUID:e(q)}),Tc=d({issuerName:e(A),
baseCertificateID:e(b(0,f(za))),objectDigestInfo:e(b(1,f(Ua)))}),Uc=d({targetCertificate:za,targetName:e(z),certDigestInfo:e(Ua)}),Vc=p({targetName:b(0,t(z)),targetGroup:b(1,t(z)),targetCert:b(2,f(Uc))}),Wc=m(Vc),Xc=oa({auditIdentity:k,targetInformation:Wc,authorityKeyIdentifier:Qa,authorityInfoAccess:m(Sa),cRLDistributionPoints:va,noRevAvail:ma},function(a){return"auditIdentity"===a||"targetInformation"===a}),Yc=d({baseCertificateID:e(b(0,f(za))),entityName:e(b(1,f(A))),objectDigestInfo:e(b(2,f(Ua)))}),
Zc=p({v1Form:A,v2Form:b(0,f(Tc))}),Cb=d({notBeforeTime:J,notAfterTime:J}),Db=d({service:z,ident:z,authInfo:e(k)}),$c=d({roleAuthority:e(b(0,f(A))),roleName:b(1,t(z))}),ad=q({unmarked:0,unclassified:1,restricted:2,confidential:3,secret:4,topSecret:5}),bd=d({type:b(0,f(l)),value:b(1,f(y))}),cd=d({policyId:b(0,f(l)),classList:L(b(1,f(ad)),["unclassified"]),securityCategories:e(b(2,f(D(bd))))}),Eb=d({policyAuthority:e(b(0,f(A))),values:m(p({octets:k,oid:l,string:R}))}),Fb=d({version:h,holder:Yc,issuer:Zc,
signature:M,serialNumber:h,attrCertValidityPeriod:Cb,attributes:Ja({authenticationInfo:D(Db),accessIdentity:D(Db),chargingIdentity:F(Eb),group:F(Eb),role:D($c),clearance:D(cd)}),issuerUniqueID:e(q),extensions:e(Xc)}),Gb=ha(d({acinfo:Fb,signatureAlgorithm:M,signatureValue:q})),ia=k,pa=k;d({ephemeralPublicKey:Hb,addedukm:e(b(0,t(k)))});d({keyInfo:qb,entityUInfo:e(b(0,t(k))),suppPubInfo:b(2,t(k))});var ja=d({encryptedKey:k,maskKey:e(b(0,f(k))),macKey:k}),dd=d({encryptionParamSet:l,ephemeralPublicKey:e(b(0,
f(Pa))),ukm:k}),Ib=d({sessionEncryptedKey:ja,transportParameters:e(b(0,f(dd)))}),Jb=d({sessionEncryptedKey:ja,ukm:d({ephemeralPublicKey:Pa,addedukm:e(b(0,t(k)))})}),Va=function(a){return{encode:function(a){var b=(new Uint8Array(new Uint8Array(a,8,32))).buffer;a=(new Uint8Array(new Uint8Array(a,40,4))).buffer;return{encryptedKey:b,macKey:a}},decode:function(c){var b=a.ukm,d=c.encryptedKey;c=c.macKey;var e=new Uint8Array(b.byteLength+d.byteLength+c.byteLength);e.set(new Uint8Array(b),0);e.set(new Uint8Array(d),
8);e.set(new Uint8Array(c),40);return e}}},ka=function(a){var c=Va(a);return{encode:function(a){return ja.encode(c.encode(a))},decode:function(a){return c.decode(ja.decode(a))}}},Aa=function(a){return{encode:function(c){return Ib.encode({sessionEncryptedKey:Va(a).encode(c),transportParameters:{encryptionParamSet:ba("sBox")[a.wrapping.sBox||"E-A"],ephemeralPublicKey:a["public"],ukm:a.ukm}})},decode:function(c){c=Ib.decode(c);a.wrapping=ca(c.transportParameters.encryptionParamSet);a.ukm=c.transportParameters.ukm;
a["public"]=c.transportParameters.ephemeralPublicKey;return Va(a).decode(c.sessionEncryptedKey)}}},Wa=function(a){return{encode:function(a){var b=(new Uint8Array(new Uint8Array(a,0,32))).buffer;a=(new Uint8Array(new Uint8Array(a,32,4))).buffer;return{encryptedKey:b,macKey:a}},decode:function(a){var b=a.encryptedKey;a=a.macKey;var d=new Uint8Array(b.byteLength+a.byteLength);d.set(new Uint8Array(b),0);d.set(new Uint8Array(a),32);return d}}},Kb=function(a){return{encode:function(c){return Jb.encode({sessionEncryptedKey:Wa(a).encode(c),
ukm:{ephemeralPublicKey:a["public"],addedukm:a.ukm}})},decode:function(c){c=Jb.decode(c);a.ukm=c.ukm.addedukm;a["public"]=c.ukm.ephemeralPublicKey;return Wa(a).decode(c.sessionEncryptedKey)}}},Xa=function(a){var c=Wa(a);return{encode:function(a){return ja.encode(c.encode(a))},decode:function(a){return c.decode(ja.decode(a))}}},Ba=function(a){return function(c){var b=a[c.id],b=b&&b.call&&b(c)||b;return{encode:function(a){b&&(a=b.encode(a));return a},decode:function(a){b&&(a=b.decode(a));return a}}}}({"id-sc-gostR3410-2001":Kb,
"id-sc-gostR3410-94":Kb,"id-GostR3410-2001":Aa,"id-GostR3410-94":Aa,"id-tc26-gost3410-12-256":Aa,"id-tc26-gost3410-12-512":Aa,"id-GostR3410-94-CryptoPro-ESDH":ka,"id-GostR3410-2001-CryptoPro-ESDH":ka,"id-tc26-agreement-gost-3410-12-256":ka,"id-tc26-agreement-gost-3410-12-512":ka,"id-sc-r3410-ESDH-r3411kdf":Xa,"id-Gost28147-89-None-KeyWrap":ka,"id-Gost28147-89-CryptoPro-KeyWrap":ka,"id-sc-cmsGostWrap":Xa,"id-sc-cmsGost28147Wrap":Xa}),Ya=function(a){return{encode:function(c){c=x(c);c.encryptedKey=K(Ba(c.keyEncryptionAlgorithm)).encode(c.encryptedKey);
return a.encode(c)},decode:function(c){c=a.decode(c);c.encryptedKey=K(Ba(c.keyEncryptionAlgorithm)).decode(c.encryptedKey);return c}}},la=l,pa=k,Za=m(h),ed=d({bodyPartPath:Za,identifier:l,content:y}),Ca=G({contentType:F(la),messageDigest:F(k),signingTime:F(Y)}),gd=G({countersignature:D(fd),unsignedData:D(ed)}),qa=d({issuer:S,serialNumber:h}),hd=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa))}),Lb=ha(d({version:h,sid:hd,digestAlgorithm:ea,signedAttrs:e(b(0,f(Ca))),signatureAlgorithm:M,
signatureValue:k,unsignedAttrs:e(b(1,f(gd)))})),fd=Lb,id=D(Lb),jd=D(ea),kd=d({version:h,certificate:ya,attributes:G}),ld=d({extendedCertificateInfo:kd,signatureAlgorithm:M,signatureValue:q}),md=d({otherCertFormat:l,otherCert:y}),nd=d({version:h,subject:p({baseCertificateID:b(0,f(za)),subjectName:b(1,f(A))}),issuer:A,signature:M,serialNumber:h,attCertValidityPeriod:Cb,attributes:Ja,issuerUniqueID:e(q),extensions:e(wa)}),od=ha(d({acInfo:nd,signatureAlgorithm:M,signatureValue:q})),$a=d({eContentType:la,
eContent:e(b(0,t(k)))}),pd=p({certificate:ya,extendedCertificate:b(0,f(ld)),v1AttrCert:b(1,f(od)),v2AttrCert:b(2,f(Gb)),other:b(3,f(md))}),qd=d({otherRevInfoFormat:l,otherRevInfo:y}),rd=p({crl:Ta,other:b(1,f(qd))}),Mb=D(pd),Nb=D(rd),sd=d({version:h,digestAlgorithms:jd,encapContentInfo:$a,certificates:e(b(0,f(Mb))),crls:e(b(1,f(Nb))),signerInfos:id}),td=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa))}),ud=Ya(d({version:h,rid:td,keyEncryptionAlgorithm:ga,encryptedKey:ia})),Ob=d({keyAttrId:l,
keyAttr:e(y)}),vd=d({subjectKeyIdentifier:pa,date:e(J),other:e(Ob)}),wd=p({issuerAndSerialNumber:qa,rKeyId:b(0,f(vd))}),xd=d({rid:wd,encryptedKey:ia}),yd=m(xd),Hb=d({algorithm:ta,publicKey:q}),zd=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa)),originatorKey:b(1,f(Hb))}),Ad=function(a){return{encode:function(c){c=x(c);var b=c.keyEncryptionAlgorithm,d=K(Ba(b));c.recipientEncryptedKeys=c.recipientEncryptedKeys.map(function(a){a=x(a);a.encryptedKey=d.encode(a.encryptedKey);return a});c.ukm=
c.ukm||b.ukm;return a.encode(c)},decode:function(c){c=a.decode(c);var b=c.keyEncryptionAlgorithm;b.ukm=b.ukm||c.ukm;var d=K(Ba(b));c.recipientEncryptedKeys.forEach(function(a){a.encryptedKey=d.decode(a.encryptedKey)});return c}}}(d({version:h,originator:b(0,t(zd)),ukm:e(b(1,t(k))),keyEncryptionAlgorithm:ga,recipientEncryptedKeys:yd})),Bd=d({keyIdentifier:k,date:e(J),other:e(Ob)}),Cd=Ya(d({version:h,kekid:Bd,keyEncryptionAlgorithm:ga,encryptedKey:ia})),Dd=Ya(d({version:h,keyDerivationAlgorithm:e(b(0,
f(Na))),keyEncryptionAlgorithm:ga,encryptedKey:ia})),Ed=d({oriType:l,oriValue:y}),Fd=p({ktri:ud,kari:b(1,f(Ad)),kekri:b(2,f(Cd)),pwri:b(3,f(Dd)),ori:b(4,f(Ed))}),ab=d({certs:e(b(0,f(Mb))),crls:e(b(1,f(Nb)))}),bb=D(Fd),cb=d({contentType:la,contentEncryptionAlgorithm:wc,encryptedContent:e(b(0,f(k)))}),Da=d({version:h,originatorInfo:e(b(0,f(ab))),recipientInfos:bb,encryptedContentInfo:cb,unprotectedAttrs:e(b(1,f(G)))}),Gd=d({version:h,digestAlgorithm:ea,encapContentInfo:$a,digest:k}),Pb=d({version:h,
encryptedContentInfo:cb,unprotectedAttrs:e(b(1,f(G)))}),Hd=d({version:h,originatorInfo:e(b(0,f(ab))),recipientInfos:bb,macAlgorithm:Ma,digestAlgorithm:e(b(1,ea)),encapContentInfo:$a,authAttrs:e(b(2,f(Ca))),mac:k,unauthAttrs:e(b(3,f(G)))}),Id=d({version:h,originatorInfo:e(b(0,f(ab))),recipientInfos:bb,authEncryptedContentInfo:cb,authAttrs:e(b(1,f(Ca))),mac:k,unauthAttrs:e(b(2,f(G)))}),Jd=p({encrypted:Pb,enveloped:b(0,f(Da)),authEnveloped:b(1,f(Id))}),la=l,ra=X(function(a){return{contentType:la,content:b(0,
t(a))}},"contentType",la)({data:k,signedData:sd,envelopedData:Da,digestedData:Gd,encryptedData:Pb,authData:Hd,encryptedKeyPkg:Jd,aKeyPackage:zc}),Kd=d({digestAlgorithm:ea,digest:k}),Ld=G({friendlyName:F(gb),localKeyId:F(k)}),Md=X(function(a){return{certId:l,certValue:b(0,t(a))}},"certId",l)({x509Certificate:k(K(ya)),sdsiCertificate:Ga},k),Nd=X(function(a){return{crlId:l,crlValue:b(0,t(a))}},"crlId",l)({x509CRL:k(K(Ta))},k),Od=X(function(a){return{secretTypeId:l,secretValue:b(0,t(a))}},"secretTypeId",
l)({secret:k},k),Pd=X(function(a){return{bagId:l,bagValue:b(0,t(a)),bagAttributes:e(Ld)}},"bagId",l)(function(a){return{keyBag:na,pkcs8ShroudedKeyBag:sb,certBag:Md,crlBag:Nd,secretBag:Od,safeContentsBag:Qb}[a]}),Qb=m(Pd),Qd=m(ra),Rd=d({mac:Kd,macSalt:k,iterations:L(h,1)}),Sd=d({version:h,authSafe:ra,macData:e(Rd)}),Td=d({issuer:z,serialNumber:h}),Ud=d({intendedAlg:e(b(0,f(n))),symmAlg:e(b(1,f(n))),encSymmKey:e(b(2,f(q))),keyAlg:e(b(3,f(n))),valueHint:e(b(4,f(k))),encValue:q}),ia=p({encryptedValue:Ud,
envelopedData:b(0,f(Da))}),Vd=p({encryptedPrivKey:b(0,ia),keyGenParameters:b(1,f(k)),archiveRemGenPrivKey:b(2,f(W))}),Wd=d({pubMethod:h({dontCare:0,x500:1,web:2,ldap:3}),pubLocation:e(z)}),Rb=d({action:h({dontPublish:0,pleasePublish:1}),pubInfos:e(m(Wd))}),Xd=h({encrCert:0,challengeResp:1}),Tb=p({thisMessage:b(0,f(q)),subsequentMessage:b(1,f(Xd)),dhMAC:b(2,f(q)),agreeMAC:b(3,f(Sb)),encryptedKey:b(4,f(Da))});d({salt:k,owf:n,iterationCount:h,mac:n});var Sb=d({algId:n,value:q}),Yd=d({authInfo:p({sender:b(0,
t(z)),publicKeyMAC:Sb}),publicKey:aa}),Zd=d({poposkInput:e(b(0,Yd)),algorithmIdentifier:n,signature:q}),$d=p({raVerified:b(0,f(ma)),signature:b(1,f(Zd)),keyEncipherment:b(2,f(Tb)),keyAgreement:b(3,f(Tb))}),ae=m(Ia({regToken:R,authenticator:R,pkiPublicationInfo:Rb,pkiArchiveOptions:Vd,oldCertID:Td,protocolEncrKey:aa})),be=d({notBefore:e(b(0,f(Y))),notAfter:e(b(1,f(Y)))}),Ub=d({version:e(b(0,f(h))),serialNumber:e(b(1,f(h))),signingAlg:e(b(2,f(n))),issuer:e(b(3,f(S))),validity:e(b(4,f(be))),subject:e(b(5,
f(S))),publicKey:e(b(6,f(aa))),issuerUID:e(b(7,f(q))),subjectUID:e(b(8,f(q))),extensions:e(b(9,f(oa)))}),Vb=d({certReqId:h,certTemplate:Ub,controls:e(ae)}),ce=d({privateKey:na,identifier:e(p([R,z]))}),Wb=d({certReq:Vb,popo:e($d),regInfo:e(m(Ia({utf8Pairs:R,certReq:Vb,encKeyWithID:ce})))});m(Wb);var Xb=d({pendToken:k,pendTime:J}),Yb=h({success:0,failed:2,pending:3,noSupport:4,confirmRequired:5,popRequired:6,partial:7}),Zb=h({badAlg:0,badMessageCheck:1,badRequest:2,badTime:3,badCertId:4,unsupportedExt:5,
mustArchiveKeys:6,badIdentity:7,popRequired:8,popFailed:9,noKeyReuse:10,internalCAError:11,tryLater:12,authDataFail:13}),de=d({cMCStatus:Yb,bodyList:m(h),statusString:e(R),otherInfo:e(p({failInfo:Zb,pendInfo:Xb}))}),ee=d({pkiDataReference:h,certReferences:m(h),extensions:m(vb)}),fe=d({request:$b,cms:ra,thePOPAlgID:n,witnessAlgID:n,witness:k}),ge=d({pkiDataBodyid:h,bodyIds:m(h)}),he=d({issuerName:z,serialNumber:h}),ie=d({issuerName:S,cRLName:e(z),time:e(J),reasons:e(Ra)}),je=d({issuerName:S,serialNumber:h,
reason:Ab,invalidityDate:e(J),passphrase:e(k),comment:e(R)}),ke=d({bodyPartID:h,thePOPAlgID:n,thePOP:k}),ac=p({bodyPartID:h,bodyPartPath:Za}),le=d({cMCStatus:Yb,bodyList:m(ac),statusString:e(R),otherInfo:e(p({failInfo:Zb,pendInfo:Xb,extendedFailInfo:d({failInfoOID:l,failInfoValue:Ha})}))}),me=d({seqNumber:h,hashAlgorithm:n,anchorHashes:m(k)}),db=m(h),ne=d({hashAlg:n,certHashes:m(k),pubInfo:Rb}),oe=d({pkiDataReference:Za,certReferences:db,replace:L(W,!0),certTemplate:Ub}),pe=d({bodyList:m(ac)}),qe=
d({proofAlgID:n,macAlgId:n,witness:k}),re=d({keyGenAlgorithm:n,macAlgorithm:n,witness:k}),bc=lb(function(a){return d({bodyPartID:h,attrType:l,attrValues:D(a)},{encode:function(a){return a.attrType},decode:function(a){return l.decode(a[1])}},Ha)({statusInfo:de,identification:R,identityProof:k,dataReturn:k,transactionId:h,senderNonce:k,recipientNonce:k,addExtensions:ee,encryptedPOP:fe,decryptedPOP:ke,lraPOPWitness:ge,getCert:he,getCRL:ie,revokeRequest:je,regInfo:k,responseInfo:k,queryPending:k,popLinkRandom:k,
popLinkWitness:k,confirmCertAcceptance:qa,statusInfoV2:le,trustedAnchors:me,authData:h,batchRequests:db,batchResponses:db,publishCert:ne,modCertTemplate:oe,controlProcessed:pe,popLinkWitnessV2:re,identityProofV2:qe})}),se=d({bodyPartID:h,certificationRequest:zb}),cc=d({bodyPartID:h,contentInfo:ra}),dc=d({bodyPartID:h,otherMsgType:l,otherMsgValue:y}),$b=p({tcr:b(0,f(se)),crm:b(1,f(Wb)),orm:b(2,f(d({bodyPartID:h,requestMessageType:l,requestMessageValue:y})))}),te=d({controlSequence:m(bc),reqSequence:m($b),
cmsSequence:m(cc),otherMsgSequence:m(dc)}),ue=d({controlSequence:m(bc),cmsSequence:m(cc),otherMsgSequence:m(dc)}),v=function(a,c){return{encode:function(b,d){b=a.encode(b);b=U().encode(b);"PEM"===(d||"DER").toUpperCase()&&(b=(w||(w=C.gostCoding)).PEM.encode(b,c));return b},decode:function(b){if("string"===typeof b||b instanceof String)b=(w||(w=C.gostCoding)).PEM.decode(b,c);b=U().decode(b);return a.decode(b)}}};return{CanocicalName:jc,GostPrivateKeyInfo:v(Ac,"PRIVATE KEY"),GostSubjectPublicKeyInfo:v(Pa,
"PUBLIC KEY"),PrivateKeyInfo:v(na,"PRIVATE KEY"),EncryptedPrivateKeyInfo:v(sb,"ENCRYPTED PRIVATE KEY"),SubjectPublicKeyInfo:v(aa,"PUBLIC KEY"),TBSCertificate:v(xb),Certificate:v(ya,"CERTIFICATE"),CertificationRequestInfo:v(yb),CertificationRequest:v(zb,"CERTIFICATE REQUEST"),TBSCertList:v(Bb),CertificateList:v(Ta,"CRL"),AttributeCertificateInfo:v(Fb),AttributeCertificate:v(Gb,"ATTRIBUTE CERTIFICATE"),SignedAttributes:v(Ca),ContentInfo:v(ra,"CMS"),SafeContents:v(Qb),AuthenticatedSafe:v(Qd),PFX:v(Sd,
"PFX"),PKIData:v(te,"PKI REQUEST"),PKIResponse:v(ue,"PKI RESPONSE")}});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(s,h){"function"===typeof define&&define.amd?define(["gostRandom"],h):"object"===typeof exports?module.exports=h(require("gostRandom")):s.gostCrypto=h(s.gostRandom)})(this,function(s){function h(a,c){if("string"===typeof a||a instanceof String)a={name:a};var d=a.name;if(!d)throw new u("Algorithm name not defined");var e=d.split("/"),e=e[0].split("-").concat(e.slice(1)),b={},d=e[0].replace(/[\.\s]/g,""),e=e.slice(1);if(0<=d.indexOf("GOST")&&0<=d.indexOf("28147"))b={name:"GOST 28147",version:1989,
mode:(a.mode||("sign"===c||"verify"===c?"MAC":"wrapKey"===c||"unwrapKey"===c?"KW":"ES")).toUpperCase(),length:a.length||64};else if(0<=d.indexOf("GOST")&&0<=d.indexOf("3411"))b={name:"GOST R 34.11",version:2012,mode:(a.mode||("deriveKey"===c||"deriveBits"===c?"KDF":"sign"===c||"verify"===c?"HMAC":"HASH")).toUpperCase(),length:a.length||256};else if(0<=d.indexOf("GOST")&&0<=d.indexOf("3410"))b={name:"GOST R 34.10",version:2012,mode:(a.mode||("deriveKey"===c||"deriveBits"===c?"DH":"SIGN")).toUpperCase(),
length:a.length||256};else throw new p("Algorithm not supported");e.forEach(function(a){a=a.toUpperCase();if(/^[0-9]+$/.test(a))if(0<=["8","16","32"].indexOf(a)||"128"===b.length&&"64"===a)if("ES"===b.mode)b.shiftBits=parseInt(a);else if("MAC"===b.mode)b.macLength=parseInt(a);else throw new p("Algorithm "+b.name+" mode "+a+" not supported");else 0<="89 94 01 12 15 1989 1994 2001 2012 2015".split(" ").indexOf(a)?(a=parseInt(a),b.version=1900>a?80>a?2E3+a:1900+a:a):0<=["64","128","256","512"].indexOf(a)?
b.length=parseInt(a):0<=["1000","2000"].indexOf(a)&&(b.iterations=parseInt(a));else if(0<="E-DEFAULT E-TEST E-A E-B E-C E-D E-SC E-Z D-TEST D-A D-SC".split(" ").indexOf(a))b.sBox=a;else if(0<="S-TEST S-A S-B S-C S-D X-A X-B X-C".split(" ").indexOf(a))b.namedParam=a;else if(0<="S-256-TEST S-256-A S-256-B S-256-C P-256 T-512-TEST T-512-A T-512-B X-256-A X-256-B T-256-TEST T-256-A T-256-B S-256-B T-256-C S-256-C".split(" ").indexOf(a))b.namedCurve=a;else if(0<=["SC","CP"].indexOf(a))b.procreator=a;else if("GOST 28147"===
b.name)if(0<=["ES","MAC","KW"].indexOf(a))b.mode=a;else if(0<=["ECB","CFB","OFB","CTR","CBC"].indexOf(a))b.mode="ES",b.block=a;else if(0<=["CPKW","NOKW","SCKW"].indexOf(a))b.mode="KW",b.keyWrapping=a.replace("KW","");else if(0<=["ZEROPADDING","PKCS5PADDING","NOPADDING","RANDOMPADDING","BITPADDING"].indexOf(a))b.padding=a.replace("PADDING","");else if(0<=["NOKM","CPKM"].indexOf(a))b.keyMeshing=a.replace("KM","");else throw new p("Algorithm "+b.name+" mode "+a+" not supported");else if("GOST R 34.11"===
b.name)if(0<=["HASH","KDF","HMAC","PBKDF2"].indexOf(a))b.mode=a;else throw new p("Algorithm "+b.name+" mode "+a+" not supported");else if("GOST R 34.10"===b.name){var d=a.replace(/[\.\s]/g,"");if(0<=d.indexOf("GOST")&&0<=d.indexOf("3411"))b.hash=a;else if(["SIGN","DH"].indexOf(a))b.mode=a;else throw new p("Algorithm "+b.name+" mode "+a+" not supported");}});if("ES"===b.mode&&(a.block&&(b.block=a.block),b.block&&(b.block=b.block.toUpperCase()),a.padding&&(b.padding=a.padding),b.padding&&(b.padding=
b.padding.toUpperCase()),a.shiftBits&&(b.shiftBits=a.shiftBits),a.keyMeshing&&(b.keyMeshing=a.keyMeshing),b.keyMeshing&&(b.keyMeshing=b.keyMeshing.toUpperCase()),"importKey"!==c&&"generateKey"!==c)){b.block=b.block||"ECB";b.padding=b.padding||("CBC"===b.block||"ECB"===b.block?"ZERO":"NO");if("CFB"===b.block||"OFB"===b.block)b.shiftBits=b.shiftBits||b.length;b.keyMeshing=b.keyMeshing||"NO"}"KW"===b.mode&&(a.keyWrapping&&(b.keyWrapping=a.keyWrapping),b.keyWrapping&&(b.keyWrapping=b.keyWrapping.toUpperCase()),
"importKey"!==c&&"generateKey"!==c&&(b.keyWrapping=b.keyWrapping||"NO"));a.sBox&&(b.sBox=a.sBox);a.namedParam&&(b.namedParam=a.namedParam);a.namedCurve&&(b.namedCurve=a.namedCurve);"importKey"!==c&&"generateKey"!==c&&("GOST 28147"===b.name&&1989===b.version?b.sBox=b.sBox||("SC"===b.procreator?"E-SC":"E-A"):"GOST 28147"===b.name&&2015===b.version?b.sBox="E-DEFAULT":"GOST R 34.11"===b.name&&1994===b.version?b.sBox=b.sBox||("SC"===b.procreator?"D-SC":"D-A"):"GOST R 34.10"===b.name&&1994===b.version?
b.namedParam=b.namedParam||("EC-DH"===b.mode?"X-A":"S-A"):"GOST R 34.10"===b.name&&2001===b.version?b.namedCurve=b.namedCurve||(256===b.length?"SC"===b.procreator?"P-256":"EC-DH"===b.mode?"X-256-A":"S-256-A":"T-512-A"===b.mode):"GOST R 34.10"===b.name&&2012===b.version&&(b.namedCurve=b.namedCurve||(256===b.length?"SC"===b.procreator?"P-256":"EC-DH"===b.mode?"X-256-A":"S-256-A":"T-512-A"===b.mode)));switch(b.mode){case "DH":a.ukm&&(b.ukm=a.ukm);a["public"]&&(b["public"]=a["public"]);break;case "SIGN":case "KW":a.ukm&&
(b.ukm=a.ukm);break;case "ES":case "MAC":a.iv&&(b.iv=a.iv);break;case "PBKDF2":a.salt&&(b.salt=a.salt);a.iterations&&(b.iterations=a.iterations);break;case "KDF":a.label&&(b.label=a.label),a.contex&&(b.context=a.contex)}if(c&&("ES"!==b.mode&&"SIGN"!==b.mode&&"MAC"!==b.mode&&"HMAC"!==b.mode&&"KW"!==b.mode&&"generateKey"===c||"ES"!==b.mode&&("encrypt"===c||"decrypt"===c)||"SIGN"!==b.mode&&"MAC"!==b.mode&&"HMAC"!==b.mode&&("sign"===c||"verify"===c)||"HASH"!==b.mode&&"digest"===c||"KW"!==b.mode&&("wrapKey"===
c||"unwrapKey"===c)||"DH"!==b.mode&&"PBKDF2"!==b.mode&&"KDF"!==b.mode&&("deriveKey"===c||"deriveBits"===c)))throw new p("Algorithm mode "+b.mode+" not valid for method "+c);a.hash&&(b.hash=a.hash);b.hash&&(("string"===typeof b.hash||b.hash instanceof String)&&b.procreator&&(b.hash=b.hash+"/"+b.procreator),b.hash=h(b.hash,"digest"));a.id&&(b.id=a.id);return b}function l(a){return k&&k.subtle&&a&&(("string"===typeof a||a instanceof String)&&-1===a.toUpperCase().indexOf("GOST")||a.name&&-1===a.name.toUpperCase().indexOf("GOST")||
a.hash&&a.hash.name&&-1===a.hash.name.toUpperCase().indexOf("GOST"))}function E(a,c){if(!a.algorithm)throw new u("Key algorithm not defined");if(!a.algorithm.name)throw new u("Key algorithm name not defined");var d=a.algorithm.name,e="GOST 28147"===d,b="GOST R 34.11"===d,f="GOST R 34.10"===d;if(!e&&!f&&!b)throw new p("Key algorithm "+d+" is unsupproted");if(!a.type)throw new u("Key type not defined");if((e||b)&&"secret"!==a.type||f&&"public"!==a.type&&"private"!==a.type)throw new F("Key type "+a.type+
" is not valid for algorithm "+d);if(!a.usages||!a.usages.indexOf)throw new u("Key usages not defined");d=0;for(e=a.usages.length;d<e;d++)if(b=a.usages[d],("wrapKey"===b||"unwrapKey"===b||"encrypt"===b||"decrypt"===b)&&"secret"!==a.type||"sign"===b&&"public"===a.type||"verify"===b&&"private"===a.type)throw new H("Key type "+a.type+" is not valid for "+b);if(c&&-1===a.usages.indexOf(c))throw new G("Key usages is not contain method "+c);if(!a.buffer)throw new u("Key buffer is not defined");d=8*a.buffer.byteLength;
if("secret"===a.type&&256!==d&&(0<=a.usages.indexOf("encrypt")||0<=a.usages.indexOf("decrypt"))||"private"===a.type&&256!==d&&512!==d||"public"===a.type&&512!==d&&1024!==d)throw new u("Key buffer has wrong size "+d+" bit");}function n(a,c,d){E(d,a);if(c){var e;switch(c.mode){case "ES":e=["sBox","keyMeshing","padding","block"];break;case "SIGN":e=["namedCurve","namedParam","sBox"];break;case "MAC":e=["sBox"];break;case "KW":e=["keyWrapping","ukm"];break;case "DH":e=["namedCurve","namedParam","sBox",
"ukm"];break;case "PBKDF2":e=["sBox","iterations","salt"];break;case "KDF":e=["context","label"]}e&&e.forEach(function(a){d.algorithm[a]&&(c[a]=d.algorithm[a])})}return d.buffer}function x(a,c,d,e,b){a={type:b||"secret",extractable:c||"false",algorithm:a,usages:d||[],buffer:e};E(a);return a}function I(a,c,d,e,b){if(!d||!d.indexOf)throw new u("Key usages not defined");var f=d.filter(function(a){return"sign"!==a});d=d.filter(function(a){return"verify"!==a});return{publicKey:x(a,c,f,e,"public"),privateKey:x(a,
c,d,b,"private")}}function y(){for(var a=0,c=arguments.length;a<c;a++){var d=arguments[a].split("."),d=z+d[0]+A+"."+d[1],e=document.querySelector('script[src="'+d+'"]');e||(e=document.createElement("script"),e.setAttribute("src",d),document.head.appendChild(e))}}function t(a,c,d){return new Promise(function(e,b){try{if(w){var D=++J;v.push({id:D,resolve:e,reject:b});w.postMessage({id:D,algorithm:a,method:c,args:d})}else f.gostEngine?e(f.gostEngine.execute(a,c,d)):b(new B("Module gostEngine not found"))}catch(m){b(m)}})}
function r(a){try{a()}catch(c){}}function g(){}var f=this,k=f.crypto||f.msCrypto,u=f.SyntaxError||Error,F=f.DataError||Error,p=f.NotSupportedError||Error,B=f.OperationError||Error,H=f.InvalidAccessError||Error,G=f.InvalidAccessError||Error;f.Promise||(f.Promise=function(){function a(a){return a&&null===a.oncomplete&&null===a.onerror?new c(function(c,b){a.oncomplete=function(){c(a.result)};a.onerror=function(){b(new B(a.toString()))}}):a}function c(d){function e(a){try{a()}catch(b){}}var b="pending",
f,m=[],h=[];try{d(function(a){"pending"===b&&(b="fulfilled",f=a,m.forEach(e))},function(a){"pending"===b&&(b="rejected",f=a,h.forEach(e))})}catch(k){"pending"===b&&(b="rejected",f=k,h.forEach(e))}this.then=function(d,e){return new c(function(c,k){function q(){var b;try{b=d?d(f):f}catch(e){k(e);return}(b=a(b))&&b.then&&b.then.call?b.then(c,k):c(b)}function g(){var b;try{b=e?e(f):f}catch(d){k(d);return}(b=a(b))&&b.then&&b.then.call?b.then(c,k):k(b)}"fulfilled"===b?q():"rejected"===b?g():(m.push(q),
h.push(g))})};this["catch"]=function(a){return this.then(void 0,a)}}c.all=function(a){return new c(function(c,b){function f(a){q++;return function(b){h[a]=b;q--;0===q&&c(h)}}function k(a){0<q&&b(a);q=0}for(var h=[],q=0,g=0,p=a.length;g<p;g++){var l=a[g];l.then&&l.then.call?l.then(f(g),k):h[g]=l}0===q&&c(h)})};return c}());var z="",A="";"undefined"!==typeof document&&function(){for(var a=/^(.*)gostCrypto(.*)\.js$/i,c=document.querySelectorAll("script"),d=0,e=c.length;d<e;d++){var b=c[d].getAttribute("src");
if(b=a.exec(b))z=b[1],A=b[2]}}();var w,v=[],J=0;if(!f.importScripts&&!f.gostEngine)try{w=new Worker(z+"gostEngine"+A+".js"),w.onmessage=function(a){for(var c=a.data.id,d=0,e=v.length;d<e&&v[d].id!==c;d++);d<e&&(c=v[d],v.splice(d,1),a.data.error?c.reject(new B(a.data.error)):c.resolve(a.data.result))},w.onerror=function(a){for(var c=0,d=v.length;c<d;c++)v[c].reject(a.error);v=[]}}catch(K){w=!1}f.importScripts||(f.importScripts=y);w||f.gostEngine||y("gostEngine.js");g.prototype.encrypt=function(a,c,
d){return(new Promise(r)).then(function(){if(l(a))return k.subtle.encrypt(a,c,d);a=h(a,"encrypt");return t(a,"encrypt",[n("encrypt",a,c),d])})};g.prototype.decrypt=function(a,c,d){return(new Promise(r)).then(function(){if(l(a))return k.subtle.decrypt(a,c,d);a=h(a,"decrypt");return t(a,"decrypt",[n("decrypt",a,c),d])})};g.prototype.sign=function(a,c,d){return(new Promise(r)).then(function(){if(l(a))return k.subtle.sign(a,c,d);a=h(a,"sign");return t(a,"sign",[n("sign",a,c),d])})};g.prototype.verify=
function(a,c,d,e){return(new Promise(r)).then(function(){if(l(a))return k.subtle.verify(a,c,d,e);a=h(a,"verify");return t(a,"verify",[n("verify",a,c),d,e])})};g.prototype.digest=function(a,c){return(new Promise(r)).then(function(){if(l(a))return k.subtle.digest(a,c);a=h(a,"digest");return t(a,"digest",[c])})};g.prototype.generateKey=function(a,c,d){return(new Promise(r)).then(function(){if(l(a))return k.subtle.generateKey(a,c,d);a=h(a,"generateKey");return t(a,"generateKey",[]).then(function(e){return e.publicKey&&
e.privateKey?I(a,c,d,e.publicKey,e.privateKey):x(a,c,d,e)})})};g.prototype.deriveKey=function(a,c,d,e,b){return(new Promise(r)).then(function(){if(l(a))return k.subtle.deriveKey(a,c,d,e,b);a=h(a,"deriveKey");d=h(d,"generateKey");a["public"]&&(a["public"].algorithm=h(a["public"].algorithm),a["public"]=n("deriveKey",a,a["public"]));return t(a,"deriveKey",[n("deriveKey",a,c)]).then(function(a){return x(d,e,b,a)})})};g.prototype.deriveBits=function(a,c,d){return(new Promise(r)).then(function(){if(l(a))return k.subtle.deriveBits(a,
c,d);a=h(a,"deriveBits");a["public"]&&(a["public"]=n("deriveBits",a,a["public"]));return t(a,"deriveBits",[n("deriveBits",a,c),d])})};g.prototype.importKey=function(a,c,d,e,b){return(new Promise(r)).then(function(){if(l(d))return k.subtle.importKey(a,c,d,e,b);var g,m,n;if("raw"===a)d=h(d,"importKey"),n=c,b&&b.indexOf&&(m=d.name.toUpperCase().replace(/[\.\s]/g,""),0<=m.indexOf("3410")&&0<=b.indexOf("sign")?g="private":0<=m.indexOf("3410")&&0<=b.indexOf("verify")&&(g="public"));else{if("pkcs8"===a&&
f.gostSyntax&&f.gostCoding)m=f.gostSyntax.GostPrivateKeyInfo.decode(c);else if("spki"===a&&f.gostSyntax&&f.gostCoding)m=f.gostSyntax.GostSubjectPublicKeyInfo.decode(c);else throw new p("Key format not supported");d=h(m.algorithm,"importKey");n=m.buffer;g=m.type;e=e||m.extractable;if(b)for(var q=0;q<b.length;q++){if(0>m.usages.indexOf(b[q]))throw F("Key usage not valid for this key");}else b=m.usages}return x(d,e,b,n,g)})};g.prototype.exportKey=function(a,c){return(new Promise(r)).then(function(){if(c&&
l(c.algorithm))return k.subtle.exportKey(a,c);if(!c.extractable)throw new G("Key not extractable");var d=n(null,null,c);if("raw"===a)return d;if("pkcs8"===a&&c.algorithm&&c.algorithm.id&&f.gostSyntax&&f.gostCoding)return f.gostSyntax.GostPrivateKeyInfo.encode(c);if("spki"===a&&c.algorithm&&c.algorithm.id&&f.gostSyntax&&f.gostCoding)return f.gostSyntax.GostSubjectPublicKeyInfo.encode(c);throw new p("Key format not supported");})};g.prototype.wrapKey=function(a,c,d,e){return(new Promise(r)).then(function(){if(l(e))return k.subtle.wrapKey(a,
c,d,e);e=h(e,"wrapKey");return t(e,"wrapKey",[n("wrapKey",e,d),n(null,null,c)]).then(function(b){if("raw"===a)return b;throw new p("Key format not supported");})})};g.prototype.unwrapKey=function(a,c,d,e,b,f,g){return(new Promise(r)).then(function(){if(l(e))return k.subtle.unwrapKey(a,c,d,e,b,f,g);e=h(e,"unwrapKey");b=h(b,"importKey");if("raw"!==a)throw new p("Key format not supported");return t(e,"unwrapKey",[n("unwrapKey",e,d),c]).then(function(a){var c;if(b&&b.name){var d=b.name.toUpperCase().replace(/[\.\s]/g,
"");0<=d.indexOf("3410")&&0<=g.indexOf("sign")?c="private":0<=d.indexOf("3410")&&0<=g.indexOf("verify")&&(c="public")}return x(b,f,g,a,c)})})};var C={};C.subtle=new g;s||k&&k.getRandomValues||y("gostRandom.js");C.getRandomValues=function(a){s=s||f.gostRandom;!s&&k&&k.getRandomValues&&(s=k);if(s)s.getRandomValues(a);else throw new p("Random generator not found");};return C});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(p,z){"function"===typeof define&&define.amd?define(["gostObject","gostCoding","gostSyntax","gostCrypto"],z):"object"===typeof exports?module.exports=z(require("gostObject"),require("gostCoding"),require("gostSyntax"),require("gostCrypto")):p.GostPKIX=z(p.gostObject,p.gostCoding,p.gostSyntax,p.gostCrypto)})(this,function(p,z,V,G){function L(){return(z||(z=r.gostCoding)).PEM}function H(){return(z||(z=r.gostCoding)).Chars}function l(a){return(V||(V=r.gostSyntax))[a]}function m(){return(G||
(G=r.gostCrypto)).subtle}function u(a){try{a()}catch(b){}}function v(a,b){return"string"===typeof a||a instanceof String||a instanceof ArrayBuffer?l(b).decode(a):a}function E(a){if("string"===typeof a||a instanceof String)a=L().decode(a);if(!(a instanceof ArrayBuffer))throw Error("Type of data must be FormatedData");return a}function C(a){a=new Uint8Array(a);(G||(G=r.gostCrypto)).getRandomValues(a);return a.buffer}function M(a){return a?a.replace(/[\u0000-\u0004]/g,""):a}function w(a,b){for(var e in a)if("buffer"!==
e&&("undefined"===typeof b[e]||M(a[e])!==M(b[e])))return!1;for(e in b)if("buffer"!==e&&("undefined"===typeof a[e]||M(a[e])!==M(b[e])))return!1;return!0}function W(a){return"number"===typeof a||a instanceof Number?a:(z||(z=r.gostCoding)).Int16.encode(a)}function Q(a){var b=typeof a;if("undefined"===b||""===a)return"0";a="number"===b||a instanceof Number?a.toString(16):a.replace("0x","");return a.toLowerCase()}function R(a,b){a=Q(a);b=Q(b);var e=Math.max(a.length,b.length),c=a;a=(Array(e+1).join("0")+
c).slice(-e);c=b;b=(Array(e+1).join("0")+c).slice(-e);return a>b?1:a<b?-1:0}function S(a,b){var e=new Uint8Array(a),c=new Uint8Array(b);if(e.length>c.length)return 1;if(e.length<c.length)return-1;for(var d=0,f=e.length;d<f;d++){if(e[d]>c[d])return 1;if(e[d]<c[d])return-1}return 0}function X(a,b){return a&&b&&(!b.issuer||w(a.tbsCertificate.issuer,b.issuer))&&(!b.serialNumber||0===R(a.tbsCertificate.serialNumber,b.serialNumber))&&(!b.subjectKeyIdentifier||0===S(a.tbsCertificate.extensions.subjectKeyIdentifier,
b.subjectKeyIdentifier))&&(!b.subject||w(a.tbsCertificate.subject,b.subject))&&(!b.date||a.tbsCertificate.validity.notBefore.getTime()<b.date.getTime()&&a.tbsCertificate.validity.notAfter.getTime()>b.date.getTime())}function N(a,b){for(var e=[],c=0,d=a.length;c<d;c++)X(a[c],b)&&e.push(a[c]);return e}function I(a,b){return N(a.getAllCertificates(),b)}function Y(a,b){for(var e=[],c=0,d=a.length;c<d;c++){var f=a[c],g=b;g.issuer&&!w(f.tbsCertList.issuer,g.issuer)||g.date&&!(f.tbsCertList.thisUpdate.getTime()<
g.date.getTime())||e.push(a[c])}return e}function Z(a,b,e,c){for(var d=[];a;){d.push(a);var f={subject:a.tbsCertificate.issuer,date:c};if(a.tbsCertificate.extensions&&a.tbsCertificate.extensions.authorityKeyIdentifier){var g=a.tbsCertificate.extensions.authorityKeyIdentifier;f.subjectKeyIdentifier=g.keyIdentifier;g.authorityCertIssuer&&g.authorityCertIssuer[0].directoryName&&(f.issuer=g.authorityCertIssuer[0].directoryName);g.authorityCertSerialNumber&&(f.serialNumber=W(g.authorityCertSerialNumber))}if(w(a.tbsCertificate.subject,
a.tbsCertificate.issuer))a=!1;else if((a=N(b,f))&&0<a.length){a=a[0];if(f=e)a:{for(var g=a,f=e,f=Y(f,{issuer:g.tbsCertificate.issuer,date:void 0}),g=g.tbsCertificate.serialNumber,h=0,k=f.length;h<k;h++)for(var s=f[h],x=0,q=s.tbsCertList.revokedCertificates.length;x<q;x++)if(0===R(s.tbsCertList.revokedCertificates[x].userCertificate,g)){f=!0;break a}f=!1}f&&(a=!1)}else a=!1}return d}function ba(a,b){var e=a.getCertificate(b);return e?Z(e,a.getAllCertificates(),a.getAllCRLs()):[]}function n(){for(var a=
{},b=0,e=arguments.length;b<e;b++){var c=arguments[b];if("object"===typeof c)for(var d in c)a[d]=c[d]}return a}function O(a){a=v(a,"Certificate");a=a.tbsCertificate.subjectPublicKeyInfo;var b="rsaEncryption"===a.algorithm.id?["verify"]:["verify","deriveKey","deriveBits"];return m().importKey("spki",a.buffer,a.algorithm,!0,b)}function P(a,b,e,c){return O(a).then(function(a){return m().verify(b,a,e,c)})}function F(a,b,e){var c,d,f,g;return(new r.Promise(u)).then(function(){var d=a.keyStore.getKey(b);
if(!d)throw Error("Private key not found");if(d.encryptionAlgorithm){c=d.encryptedData;g=d.encryptionAlgorithm;if("PBES2"===g.id||"id-sc-pbeWithGost3411AndGost28147"===g.id||"id-sc-pbeWithGost3411AndGost28147CFB"===g.id){if(!e||!("string"===typeof e||e instanceof String))throw Error("Password required to decrypt key");f=g.derivation;g=g.encryption;return m().importKey("raw",H().decode(e,"utf8"),f,!1,["deriveKey"])}if(!e||"secret"!==e.type)throw Error("Secret key required to decrypt key");}else c=
d instanceof ArrayBuffer?d:l("PrivateKeyInfo").encode(d)}).then(function(a){return f?m().deriveKey(f,a,g,!0,["decrypt"]):e}).then(function(a){return g?m().decrypt(g,a,c):c}).then(function(b){try{d=l("PrivateKeyInfo").decode(b)}catch(e){d=b}if(d.privateKeyAlgorithm){var c="rsaEncryption"===d.privateKeyAlgorithm.id?["sign"]:["sign","deriveKey","deriveBits"];return m().importKey("pkcs8",b,d.privateKeyAlgorithm,!0,c)}c=["encrypt","decrypt","wrapKey","unwrapKey"];return m().importKey("raw",b,a.provider.encryption,
!0,c)})}function K(a,b,e,c){var d,f,g,h,k=b.type;return(new r.Promise(u)).then(function(){return"secret"===k?m().exportKey("raw",b):m().exportKey("pkcs8",b)}).then(function(b){d=b;if(c){if("string"===typeof c||c instanceof String)return g=n(a.provider.pbes.derivation,{salt:C(32),iterations:1}),h=n(a.provider.pbes.encryption),h.iv||(h.iv=C(8)),m().importKey("raw",H().decode(c,"utf8"),g,!1,["deriveKey"]);if("secret"===c.type)h=n(a.provider.encryption),h.iv||(h.iv=C(8));else throw Error("Password must be string or secret key type");
}else f="secret"===k?d:l("PrivateKeyInfo").decode(d)}).then(function(a){return g?m().deriveKey(g,a,h,!0,["encrypt"]):c}).then(function(a){return h&&m().encrypt(h,a,d)}).then(function(b){h&&(f=g?{encryptionAlgorithm:n(a.provider.pbes,{derivation:g,encryption:h}),encryptedData:b}:{encryptionAlgorithm:h,encryptedData:b});e&&a.keyStore.setKey(e,f);return f})}function J(a){a=v(a,"Certificate");a=a.tbsCertificate.subjectPublicKeyInfo.algorithm.id;var b=(p||(p=r.gostObject)).providers,e;for(e in b){var c=
b[e];if(c.generation.id===a)return c}}function T(a){this.entries={};if(a){var b=JSON.parse(a.getItem("gostCrypto.keyStore")||"{}"),e;for(e in b){var c=this.entries[e]={},d=b[e];d.crl&&(c.crl=l("CertificateList").decode(d.crl));d.request&&(c.request=l("CertificationRequest").decode(d.request));d.cert&&(c.cert=l("Certificate").decode(d.cert));if(d.key)try{c.key=l("PrivateKeyInfo").decode(d.key)}catch(f){try{c.key=l("EncryptedPrivateKeyInfo").decode(d.key)}catch(g){c.key=L().decode(d.key,"KEY")}}}this.save=
function(){var b={},d;for(d in this.entries){var e=b[d]={},c=this.entries[d];c.crl&&(e.crl=l("CertificateList").encode(c.crl,"PEM"));c.request&&(e.request=l("CertificationRequest").encode(c.request,"PEM"));c.cert&&(e.cert=l("Certificate").encode(c.cert,"PEM"));if(c.key)try{e.key=l("PrivateKeyInfo").encode(c.key,"PEM")}catch(f){try{e.key=l("EncryptedPrivateKeyInfo").encode(c.key,"PEM")}catch(g){e.key=L().encode(c.key,"KEY")}}}a.setItem("gostCrypto.keyStore",JSON.stringify(b))}}}function $(a,b,e){this.provider=
(p||(p=r.gostObject)).providers[a];this.format=(b||"DER").toUpperCase();this.keyStore=e?e.getItem&&e.setItem?new T(e):e:new T}var r=this;T.prototype={aliases:function(){var a=[],b;for(b in this.entries)a.push(b);return a},containsAlias:function(a){return a in this.entries},deleteEntry:function(a){delete this.entries[a];this.save&&this.save()},getCertificate:function(a){if(a=this.entries[a])return a.cert},getCRL:function(a){if(a=this.entries[a])return a.crl},getRequest:function(a){if(a=this.entries[a])return a.request},
getKey:function(a){if(a=this.entries[a])return a.key},setCertificate:function(a,b){(this.entries[a]||(this.entries[a]={})).cert=v(b,"Certificate");this.save&&this.save()},setCRL:function(a,b){(this.entries[a]||(this.entries[a]={})).crl=v(b,"CertificateList");this.save&&this.save()},setRequest:function(a,b){(this.entries[a]||(this.entries[a]={})).request=v(b,"CertificationRequest");this.save&&this.save()},setKey:function(a,b){try{b=v(b,"PrivateKeyInfo")}catch(e){try{b=v(b,"EncryptedPrivateKeyInfo")}catch(c){b=
E(b)}}(this.entries[a]||(this.entries[a]={})).key=b;this.save&&this.save()},getAllCertificates:function(){var a=[],b;for(b in this.entries){var e=this.entries[b];e.cert&&a.push(e.cert)}return a},getAllCRLs:function(){var a=[],b;for(b in this.entries){var e=this.entries[b];e.crl&&a.push(e.crl)}return a}};$.prototype={importKeyStore:function(a,b){var e=this,c=e.keyStore,d,f,g,h,k;return(new r.Promise(u)).then(function(){a=v(a,"PFX");h=a.authSafe;if(b&&!a.macData)throw Error("Password based MAC must present");
if("signedData"!==h.contentType&&"data"!==h.contentType)throw Error("Unsupported format");if(b)return d=n(e.provider.pbmac.derivation,{salt:a.macData.macSalt,iterations:a.macData.iterations}),f=n(e.provider.pbmac.hmac),m().importKey("raw",H().decode(b,"utf8"),d,!1,["deriveKey"])}).then(function(a){return d&&m().deriveKey(d,a,f,!0,["verify"])}).then(function(b){g=b;return f&&m().verify(f,g,a.macData.mac.digest,h.buffer)}).then(function(a){if(!a)throw Error("MAC not verified");return"signedData"===
h.contentType?e.verifyData(h):h}).then(function(a){h=a;if("data"!==h.contentType)throw Error("Unsupported format");k=l("AuthenticatedSafe").decode(h.content);return Promise.all(k.map(function(a){if("encryptedData"===a.contentType)return e.decryptData(a,b);if("data"===a.contentType)return a;throw Error("Format not supported");}))}).then(function(b){k=b;var d=function(a){a.forEach(function(a){var b=a.bagAttributes&&a.bagAttributes.friendlyName||L().encode(C(12));switch(a.bagId){case "keyBag":case "pkcs8ShroudedKeyBag":c.setKey(b,
a.bagValue);break;case "certBag":"x509Certificate"===a.bagValue.certId&&c.setCertificate(b,a.bagValue.certValue);break;case "crlBag":"x509CRL"===a.bagValue.crlId&&c.setCRL(b,a.bagValue.crlValue);break;case "safeContentsBag":d(a.bagValue)}})};k.forEach(function(a){d(l("SafeContents").decode(a.content))});return a})},exportKeyStore:function(a,b){var e=this,c=e.keyStore,d,f,g,h,k;return(new r.Promise(u)).then(function(){for(var f=c.aliases(),k=[],q=0,ca=f.length;q<ca;q++){var B=f[q],A=c.getKey(B),r;
A&&(A.privateKeyAlgorithm?r={bagId:"keyBag",bagValue:v(A,"PrivateKeyInfo")}:A.encryptionAlgorithm&&(r={bagId:"pkcs8ShroudedKeyBag",bagValue:A}),r.bagAttributes={localKeyId:q.toString(16),friendlyName:B},k.push(r));(A=c.getCertificate(B))&&k.push({bagId:"certBag",bagValue:{certId:"x509Certificate",certValue:A},bagAttributes:{friendlyName:B}});(A=c.getCRL(B))&&k.push({bagId:"crlBag",bagValue:{crlId:"x509CRL",crlValue:A},bagAttributes:{friendlyName:B}})}d=l("SafeContents").encode(k);b=(b||"mac").toLowerCase();
if(a)return g=n(e.provider.pbmac.derivation,{salt:C(32),iterations:1}),h=n(e.provider.pbmac.hmac),m().importKey("raw",H().decode(a,"utf8"),g,!1,["deriveKey"]);if("encrypt"===b)throw Error("Password required for MAC calculation");}).then(function(a){return g&&m().deriveKey(g,a,h,!0,["sign"])}).then(function(c){k=c;return"encrypt"===b?e.encryptData(d,"pbes",a):{contentType:"data",content:d}}).then(function(a){a=v(a,"ContentInfo");f={contentType:"data",content:l("AuthenticatedSafe").encode([a])};f.buffer=
l("ContentInfo").encode(f);return h&&m().sign(h,k,f.buffer)}).then(function(a){var b={version:3,authSafe:f};a&&(b.macData={mac:{digestAlgorithm:h.hash,digest:a},macSalt:g.salt,iterations:g.iterations});return l("PFX").encode(b,e.format)})},exportKey:function(a,b,e){var c=this;return(new r.Promise(u)).then(function(){return F(c,a,e)}).then(function(a){b=(b||"p8").toLowerCase();switch(b){case "p8":return K(c,a);case "p8e":if(!e)throw Error("Password required for export to encrypted format");return K(c,
a,void 0,e);case "p12":throw Error("Not yet implemented");}}).then(function(a){switch(b){case "p8":return l("PrivateKeyInfo").encode(a,c.format);case "p8e":return l("EncryptedPrivateKeyInfo").encode(a,c.format)}})},importKey:function(a,b,e){var c=this;return(new r.Promise(u)).then(function(){try{a=v(a,"PrivateKeyInfo")}catch(d){try{a=v(a,"EncryptedPrivateKeyInfo")}catch(f){a=E(a)}}c.keyStore.setKey(b,a);if(!a.encryptionAlgorithm&&e)return F(c,b)}).then(function(d){return d?K(c,d,b,e):a})},createCertificate:function(a,
b,e){var c=this,d={},f={},g,h;return(new r.Promise(u)).then(function(){a=a||{};d.version=2;f.signatureAlgorithm=d.signature=a.signature||c.provider.signature;if(!d.signature)throw Error("Signature Algorithm not defined");var b=c.provider.generation;if(!b)throw Error("Key Algorithm not defined");return m().generateKey(b,!0,["sign","verify"])}).then(function(a){g=a.publicKey;h=a.privateKey;return m().exportKey("spki",g)}).then(function(a){d.subjectPublicKeyInfo=l("SubjectPublicKeyInfo").decode(a);return m().digest(c.provider.digest,
a)}).then(function(b){b=(new Uint8Array(new Uint8Array(b,0,20))).buffer;d.subject=a.subject||a.issure;d.issuer=d.subject;if(!d.subject)throw Error("Subject or issuer not defined");d.serialNumber=a.serialNumber||1;var c={};a.validity&&a.validity.notBefore?c.notBefore=a.validity.notBefore:(c.notBefore=new Date,c.notBefore.setHours(0,0,0,0));a.validity&&a.validity.notAfter?c.notAfter=a.validity.notAfter:(c.notAfter=new Date(c.notBefore),c.notAfter.setFullYear(c.notAfter.getFullYear()+25));d.validity=
c;c=a.extensions||{};c.keyUsage=c.keyUsage||"digitalSignature nonRepudiation keyEncipherment dataEncipherment keyAgreement keyCertSign cRLSign".split(" ");c.basicConstraints=c.basicConstraints||{cA:!0};c.extKeyUsage=c.extKeyUsage||"serverAuth clientAuth codeSigning emailProtection ipsecEndSystem ipsecTunnel ipsecUser timeStamping OCSPSigning".split(" ");c.subjectKeyIdentifier=b;c.authorityKeyIdentifier={keyIdentifier:b,authorityCertIssuer:[{directoryName:d.issuer}],authorityCertSerialNumber:d.serialNumber};
d.extensions=c;d.buffer=l("TBSCertificate").encode(d);return m().sign(f.signatureAlgorithm,h,d.buffer)}).then(function(a){f.tbsCertificate=d;f.signatureValue=a;f.buffer=l("Certificate").encode(f);return K(c,h,b,e)}).then(function(){c.keyStore.setCertificate(b,f);return l("Certificate").encode(f,c.format)})},issueCertificate:function(a,b,e,c){var d=this,f=d.keyStore,g,h={},k={},s,x,q;return(new r.Promise(u)).then(function(){x=f.getRequest(b);s=x.requestInfo;h.version=2;h.subjectPublicKeyInfo=s.subjectPublicKeyInfo;
return m().importKey("spki",s.subjectPublicKeyInfo.buffer,s.subjectPublicKeyInfo.algorithm,!0,["verify"])}).then(function(a){return m().verify(x.signatureAlgorithm,a,x.signatureValue,s.buffer)}).then(function(b){if(!b)throw Error("Request signature is not valid");q=f.getCertificate(e);if(!q)throw Error("Authority certificate not found");g=J(q)||d.provider;k.signatureAlgorithm=h.signature=a.signature||g.signature;if(!h.signature)throw Error("Signature Algorithm not defined");return m().digest(g.digest,
h.subjectPublicKeyInfo.buffer)}).then(function(b){b=(new Uint8Array(new Uint8Array(b,0,20))).buffer;h.subject=s.subject;if(!h.subject)throw Error("Subject not defined");var k=q.tbsCertificate.extensions&&q.tbsCertificate.extensions.keyUsage;if(k&&0>k.indexOf("keyCertSign"))throw Error("Issuer key can't be used for sign certificate");var g;a.validity&&a.validity.notBefore?g=a.validity.notBefore:(g=new Date,g.setHours(0,0,0,0));var l=q.tbsCertificate.validity;if(!l||l.notBefore.getTime()>g.getTime())throw Error("Issuer certificate is not released");
if(!l||l.notAfter.getTime()<g.getTime())throw Error("Issuer certificate expired");h.issuer=q.tbsCertificate.issuer;var k=q.tbsCertificate.serialNumber,m=(q.tbsCertificate.extensions||{}).subjectKeyIdentifier,x=(q.tbsCertificate.extensions||{}).basicConstraints,x=(x=x&&x.pathLenConstraint)?x+1:0,r=q.tbsCertificate.issuer;if(a.serialNumber)h.serialNumber=a.serialNumber;else{for(var y=I(f,{issuer:h.issuer}),n=1,u=0,v=y.length;u<v;u++)if(0<=R(y[u].tbsCertificate.serialNumber,n)){for(var n=y[u].tbsCertificate.serialNumber,
n=Q(n),D="",z=1,U=n.length-1;0<=U;--U){var p=n.charCodeAt(U);1===z&&(102===p?p=48:(z=0,57===p?p=97:p++));D=String.fromCharCode(p)+D}1===z&&(D="1"+D);n="0x"+D}h.serialNumber=n}y={};y.notBefore=g;y.notAfter=a.validity&&a.validity.notAfter?a.validity.notAfter:l.notAfter;h.validity=y;g=a.extensions||{};l=s.attributes&&(s.attributes.extensionRequest||s.attributes.msCertExtensions)||{};g.keyUsage=g.keyUsage||l.keyUsage||["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement"];
g.basicConstraints=g.basicConstraints||l.basicConstraints||{cA:0<=g.keyUsage.indexOf("keyCertSign"),pathLenConstraint:x};g.extKeyUsage=g.extKeyUsage||l.extKeyUsage||["clientAuth","emailProtection"];g.subjectKeyIdentifier=b;g.authorityKeyIdentifier={keyIdentifier:m,authorityCertIssuer:[{directoryName:r}],authorityCertSerialNumber:k};h.extensions=g;return F(d,e,c)}).then(function(a){h.buffer=l("TBSCertificate").encode(h);return m().sign(k.signatureAlgorithm,a,h.buffer)}).then(function(a){k.tbsCertificate=
h;k.signatureValue=a;k.buffer=l("Certificate").encode(k);return f.setCertificate(b,k)}).then(function(){return l("Certificate").encode(k,d.format)})},exportCertificate:function(a,b){var e=this;return(new r.Promise(u)).then(function(){var c=e.keyStore.getCertificate(a);if(!c)throw Error("Certificate not found");switch((b||"x509").toLowerCase()){case "p7c":return l("ContentInfo").encode({contentType:"signedData",content:{version:1,digestAlgorithms:[],encapContentInfo:{eContentType:"data"},certificates:[c],
signerInfos:[]}},e.format);case "p12":return l("PFX").encode({version:3,authSafe:{contentType:"data",content:l("SafeContents").encode([{bagId:"certBag",crltValue:{certId:"x509Certificate",certValue:c},bagAttributes:"string"===typeof a?{friendlyName:a}:void 0}])}},e.format);default:return l("Certificate").encode(c,e.format)}})},importCertificate:function(a,b){var e=this.keyStore,c;return(new r.Promise(u)).then(function(){try{a=v(a,"ContentInfo")}catch(b){a=v(a,"Certificate")}if(a.contentType&&("signedData"===
a.contentType&&(a=a.content.certificates[0]),!a))throw Error("Invalid format");c=a.tbsCertificate;if(!c)throw Error("Invalid format");var f;if(w(a.tbsCertificate.subject,a.tbsCertificate.issuer))f=a;else if(e){f={subject:a.tbsCertificate.issuer};if(a.tbsCertificate.extensions&&a.tbsCertificate.extensions.authorityKeyIdentifier){var g=a.tbsCertificate.extensions.authorityKeyIdentifier;f.subjectKeyIdentifier=g.keyIdentifier;g.authorityCertIssuer&&g.authorityCertIssuer[0].directoryName&&(f.issuer=g.authorityCertIssuer[0].directoryName);
g.authorityCertSerialNumber&&(f.serialNumber=W(g.authorityCertSerialNumber))}if((f=I(e,f))&&0<f.length)f=f[0];else throw Error("Issuer for certificate not found in store");}return P(f,a.signatureAlgorithm,a.signatureValue,c.buffer)}).then(function(c){if(!c)throw Error("Certificate has invalid signature");b&&e.setCertificate(b,a);return a})},validateCertificate:function(a,b){var e=this.keyStore,c=[];return(new r.Promise(u)).then(function(){var d=a;d instanceof Array||(d=[a]);d=d.map(function(a){return v(a,
"Certificate")});b=b||new Date;c=Z(d[0],d.concat(e.getAllCertificates()),e.getAllCRLs(),b);for(var f=!1,d=c.length-1;0<=d;--d)if(0<I(e,{issuer:c[d].tbsCertificate.issuer,serialNumber:c[d].tbsCertificate.serialNumber}).length){f=!0;break}if(!f)throw Error("There are not trusted certificates in validation path");for(var f=[],d=0,g=c.length;d<g;d++){var h=c[d],k=d+1;k===g&&w(h.tbsCertificate.issuer,h.tbsCertificate.subject)&&(k=d);k<g&&f.push(P(c[k],h.signatureAlgorithm,h.signatureValue,h.tbsCertificate.buffer))}return Promise.all(f)}).then(function(a){for(var b=
0,e=a.length;b<e;b++)if(!0!==a[b])throw Error("Certificate in path has invalid signature");return c})},createRequest:function(a,b,e){var c=this,d={},f={},g,h;return(new r.Promise(u)).then(function(){a=a||{};d.signatureAlgorithm=a.signatureAlgorithm||c.provider.signature;var b=c.provider.generation;if(!d.signatureAlgorithm)throw Error("Signature Algorithm not defined");if(!b)throw Error("Key Algorithm not defined");return m().generateKey(b,!0,["sign","verify"])}).then(function(a){g=a.publicKey;h=a.privateKey;
return m().exportKey("spki",g)}).then(function(b){f.subjectPublicKeyInfo=l("SubjectPublicKeyInfo").decode(b);f.subject=a.subject;if(!f.subject)throw Error("Subject not defined");f.version=0;b=a.extensions||{};b.keyUsage=b.keyUsage||["digitalSignature","nonRepudiation","dataEncipherment","keyAgreement"];b.extKeyUsage=["clientAuth","emailProtection"];f.attributes={extensionRequest:b};f.buffer=l("CertificationRequestInfo").encode(f);return m().sign(d.signatureAlgorithm,h,f.buffer)}).then(function(a){d.requestInfo=
f;d.signatureValue=a;d.buffer=l("CertificationRequest").encode(d);return K(c,h,b,e)}).then(function(){c.keyStore.setRequest(b,d);return l("CertificationRequest").encode(d,c.format)})},exportRequest:function(a){var b=this,e;return(new r.Promise(u)).then(function(){e=b.keyStore.getRequest(a);if(!e)throw Error("Certification request not found");return l("CertificationRequest").encode(e,b.format)})},importRequest:function(a,b){var e=this,c;return(new r.Promise(u)).then(function(){a=v(a,"CertificationRequest");
c=a.requestInfo;var b=c.subjectPublicKeyInfo;return m().importKey("spki",b.buffer,b.algorithm,!0,["verify"])}).then(function(b){return m().verify(a.signatureAlgorithm,b,a.signatureValue,c.buffer)}).then(function(c){if(!c)throw Error("Request signature is not valid");b&&e.keyStore.setRequest(b,a);return a})},updateCRL:function(a,b,e){var c=this,d=c.keyStore,f={},g;return(new r.Promise(u)).then(function(){a=a||{};var h=d.getCertificate(b);if(!h)throw Error("Issuer certificate not found");g=J(h)||c.provider;
if(0>((h.tbsCertificate.extensions||{}).keyUsage||[]).indexOf("cRLSign"))throw Error("Issuer has not rights for CRL sign");var k=h.tbsCertificate.extensions&&h.tbsCertificate.extensions.keyUsage;if(k&&0>k.indexOf("cRLSign"))throw Error("Issuer key can't be used for sign CRL");if(a.issuer&&w(a.issuer,h.tbsCertificate.issue))throw Error("CRL prototype and authority certificate have different issuers");(k=d.getCRL(b))?f=k.tbsCertList:(k=Y(d.getAllCRLs,{issuer:h.tbsCertificate.issuer}))&&0<k.length?f=
k[0].tbsCertList:(f.issuer=h.tbsCertificate.issuer,f.revokedCertificates=[]);f.version=1;f.signature=a.signature||g.signature;a.thisUpdate?f.thisUpdate=a.thisUpdate:(f.thisUpdate=new Date,f.thisUpdate.setHours(0,0,0,0));a.nextUpdate?f.nextUpdate=a.nextUpdate:(f.nextUpdate=new Date(f.thisUpdate),f.nextUpdate.setFullYear(f.nextUpdate.getFullYear()+25));k=h.tbsCertificate.validity;if(!k||k.notBefore.getTime()>f.thisUpdate.getTime())throw Error("Issuer certificate is not released");if(!k||k.notAfter.getTime()<
f.thisUpdate.getTime())throw Error("Issuer certificate expired");k=f.revokedCertificates;if(a.revokedCertificates)for(var l=0,m=a.revokedCertificates.length;l<m;l++){var q=a.revokedCertificates[l],n={};if(!q.userCertificate)throw Error("Serail number of revoked certificate not found");n.userCertificate=q.userCertificate;q.revocationDate?n.revocationDate=q.revocationDate:(n.revocationDate=new Date,n.revocationDate.setHours(0,0,0,0));q=q.crlEntryExtensions||{};q.cRLReason=q.cRLReason||"unspecified";
n.crlEntryExtensions=q;k.push(n)}k=a.crlExtensions||{};k.authorityKeyIdentifier={keyIdentifier:(h.tbsCertificate.extensions||{}).subjectKeyIdentifier||"0",authorityCertIssuer:[{directoryName:h.tbsCertificate.issuer}],authorityCertSerialNumber:h.tbsCertificate.serialNumber};k.cRLNumber=k.cRLNumber||0;f.crlExtensions=k;return F(c,b,e)}).then(function(a){f.buffer=l("TBSCertList").encode(f);return m().sign(f.signature,a,f.buffer)}).then(function(a){a={tbsCertList:f,signatureAlgorithm:f.signature,signatureValue:a};
a.buffer=l("CertificateList").encode(a);d.setCRL(b,a);return l("CertificateList").encode(a,c.format)})},exportCRL:function(a,b){var e=this;return(new r.Promise(u)).then(function(){var c=[e.keyStore.getCRL(a)];if(!c)throw Error("CRL not found");switch((b||"x509").toLowerCase()){case "p7c":return l("ContentInfo").encode({contentType:"signedData",content:{version:4,digestAlgorithms:[],encapContentInfo:{eContentType:"data"},crls:[{crl:c}],signerInfos:[]}},e.format);case "p12":return l("PFX").encode({version:3,
authSafe:{contentType:"data",content:l("SafeContents").encode([{bagId:"crlBag",crltValue:{crlId:"x509CRL",crltValue:c},bagAttributes:"string"===typeof a?{friendlyName:a}:void 0}])}},e.format);default:return l("CertificateList").encode(c,e.format)}})},importCRL:function(a,b){var e=this.keyStore,c,d;return(new r.Promise(u)).then(function(){try{a=v(a,"ContentInfo")}catch(b){a=v(a,"CertificateList")}if(a.contentType&&("signedData"===a.contentType&&(a=a.content.crls[0]),!a))throw Error("Invalid format");
c=a.tbsCertList;if(!c)throw Error("Invalid format");var g=I(e,{issuer:c.issuer});if(g&&0<g.length)d=g[0];else throw Error("Issuer certificate not found");return P(d,a.signatureAlgorithm,a.signatureValue,c.buffer)}).then(function(c){if(!c)throw Error("Certification list has invalid signature");b&&e.setCRL(b,a);return a})},signData:function(a,b,e,c){var d=this,f=d.keyStore,g,h,k,s;b=b||[];b instanceof Array||(b=[b]);b=b.map(function(a){return(a||"").toLowerCase()});return(new r.Promise(u)).then(function(){try{a=
v(a,"ContentInfo")}catch(c){a={contentType:"data",content:E(a)}}var l=f.getCertificate(e);if(!l)throw Error("Signer certificate not found");s=J(l)||d.provider;h={version:1,digestAlgorithm:s.digest,sid:{issuerAndSerialNumber:{issuer:l.tbsCertificate.issuer,serialNumber:l.tbsCertificate.serialNumber}}};if("signedData"===a.contentType){g=a;k=a.encapContentInfo.eContent;g.signerInfos=(g.signerInfos||[]).push(h);var n;g.digestAlgorithms=g.digestAlgorithms||[];g.digestAlgorithms.forEach(function(a){a.id===
g.digestAlgorithm.id&&(n=!0)});n||g.digestAlgorithms.push(g.digestAlgorithm);0<=b.indexOf("detached")&&(a.encapContentInfo.eContent=void 0)}else k=a.content.buffer||a.content,g={version:1,digestAlgorithms:[h.digestAlgorithm],encapContentInfo:{eContentType:a.contentType,eContent:0<=b.indexOf("detached")?void 0:k},signerInfos:[h]};if(0<=b.indexOf("certpath")){g.certificates=g.certificates||[];var B=g.certificates.map(function(a){return a.certificate});ba(f,e).forEach(function(a){0===N(B,{issuer:a.tbsCertificate.issuer,
serialNumber:a.tbsCertificate.serialNumber}).length&&g.certificates.push({certificate:a})})}if(0<=b.indexOf("attrs"))return m().digest(h.digestAlgorithm,k)}).then(function(a){a&&(h.signedAttrs={contentType:g.encapContentInfo.eContentType,messageDigest:a,signingTime:new Date},k=h.signedAttrs.buffer=l("SignedAttributes").encode(h.signedAttrs));return F(d,e,c)}).then(function(a){h.signatureAlgorithm=s.generation;var b=n(h.signatureAlgorithm,{hash:h.digestAlgorithm});return m().sign(b,a,k)}).then(function(a){h.signatureValue=
a;return l("ContentInfo").encode({contentType:"signedData",content:g},d.format)})},digestData:function(a){var b=this,e;return(new r.Promise(u)).then(function(){try{a=v(a,"ContentInfo")}catch(c){a={contentType:"data",content:E(a)}}var d=a.content.buffer||a.content;e={version:1,digestAlgorithm:b.provider.digest,encapContentInfo:{eContentType:a.contentType,eContent:d}};return m().digest(e.digestAlgorithm,d)}).then(function(a){e.digest=a;return l("ContentInfo").encode({contentType:"digestedData",content:e},
b.format)})},encryptData:function(a,b,e,c,d){var f=this,g=f.keyStore,h,k,s,x,q,v,B,A,p,aa,w,t;return(new r.Promise(u)).then(function(){a=E(a);b=(b||"keyagree").toLowerCase();if("keyagree"!==b&&"keytrans"!==b&&"kek"!==b&&"pbkek"!==b&&"keyman"!==b&&"pbes"!==b)throw Error("Invalid envelop mode");switch(b){case "keyagree":case "keytrans":s=e instanceof Array?e:[e];s=s.map(function(a){return g.getCertificate(a)});t=s.map(function(a){return J(a)||f.provider});break;case "kek":case "keyman":d=c;c=e;if(!c||
"string"!==typeof c)throw Error("Alias of secret key must be specified as 4th parameter");s=[e];t=[f.provider];break;case "pbkek":case "pbes":d=e;if(!d||"string"!==typeof d)throw Error("Password must be specified as 4th parameter");s=[e];t=[f.provider]}p=s.map(function(a,b){return C(8)});w="pbes"!==b&&"keyman"!==b;if("pbes"===b)return G.subtle.importKey("raw",H().decode(d,"utf8"),t[0].derivation,!0,["deriveKey"])}).then(function(a){h=n(t[0].encryption);switch(b){case "keyman":return F(f,c,d);case "pbes":return m().deriveKey(n(t[0].derivation,
{salt:p[0]}),a,h,!0,["encrypt"]);default:return m().generateKey(h,!0,["encrypt"])}}).then(function(b){x=b;h.iv||(h.iv=C(8));return m().encrypt(h,x,a)}).then(function(a){q={contentType:"data",contentEncryptionAlgorithm:h,encryptedContent:a};switch(b){case "keyagree":case "keytrans":return Promise.all(s.map(function(a){return O(a)}));case "pbes":a=n(t[0].pbes,{derivation:n(t[0].derivation,{salt:p[0]}),encryption:h}),q.contentEncryptionAlgorithm=a}}).then(function(a){switch(b){case "keyagree":case "keytrans":B=
a;case "kek":return c?F(f,c,d):m().generateKey(t[0].generation,!0,["deriveKey"]);case "pbkek":return G.subtle.importKey("raw",H().decode(d,"utf8"),t[0].derivation,!0,["deriveKey"])}}).then(function(a){if(w){v=a.privateKey||a;var d=c&&g.getCertificate(c);switch(b){case "keyagree":return c?d.tbsCertificate.subjectPublicKeyInfo:m().exportKey("spki",a.publicKey);case "keytrans":return c?O(d):a.publicKey}d&&d.tbsCertificate&&d.tbsCertificate.extensions&&(aa=d.tbsCertificate.extensions.subjectKeyIdentifier)}}).then(function(a){if(w)return A=
a,k="keytrans"===b&&t[0].transwrapping||t[0].wrapping,Promise.all(s.map(function(a,c){var d;switch(b){case "kek":return v;case "pbkek":d=n(t[c].derivation,{salt:p[c]});break;default:d=n(t[c].agreement,{"public":B[c],ukm:p[c]})}return m().deriveKey(d,v,k,!0,["wrapKey"])}))}).then(function(a){if(w)return Promise.all(s.map(function(b,c){return m().wrapKey("raw",x,a[c],n(k,{ukm:p[c]}))}))}).then(function(a){if(w){var d=s.map(function(d,e){var f=s[e].tbsCertificate,f=f?{issuerAndSerialNumber:{issuer:f.issuer,
serialNumber:f.serialNumber}}:void 0;switch(b){case "keyagree":var g=l("SubjectPublicKeyInfo").decode(A),h=n(g.algorithm,t[e].agreement,{wrapping:n(k)});return{kari:{version:3,originator:{originatorKey:{algorithm:g.algorithm,publicKey:g.subjectPublicKey}},ukm:p[e],keyEncryptionAlgorithm:h,recipientEncryptedKeys:[{rid:f,encryptedKey:a[e]}]}};case "keytrans":return h=n(A.algorithm,{ukm:p[e],"public":A,wrapping:n(k)}),{ktri:{version:0,rid:f,keyEncryptionAlgorithm:h,encryptedKey:a[e]}};case "kek":return{kekri:{version:4,
kekid:{keyIdentifier:aa||(z||(z=r.gostCoding)).BER.encode(c)},keyEncryptionAlgorithm:n(k,{ukm:p[e]}),encryptedKey:a[e]}};case "pbkek":return{pwri:{version:0,keyDerivationAlgorithm:n(t[e].derivation,{salt:p[e]}),keyEncryptionAlgorithm:n(k,{ukm:p[e]}),encryptedKey:a[e]}}}}),d={version:b=3,recipientInfos:d,encryptedContentInfo:q};return l("ContentInfo").encode({contentType:"envelopedData",content:d},f.format)}return l("ContentInfo").encode({contentType:"encryptedData",content:{version:0,encryptedContentInfo:q}},
f.format)})},verifyData:function(a,b){var e=this,c=e.keyStore,d,f,g;return(new r.Promise(u)).then(function(){var h=v(a,"ContentInfo");if("signedData"!==h.contentType&&"digestedData"!==h.contentType)throw Error("Invalid signed or digested data format");d=h.content;b&&(b=E(b));f=(g=d.encapContentInfo)&&g.eContent&&g.eContent||b;if(d.signerInfos)return Promise.all(d.signerInfos.map(function(a){a=a.sid.issuerAndSerialNumber;a={issuer:a.issuer,serialNumber:a.serialNumber};var b=I(c,a);if(0<b.length)return b;
var f=(d.certificates||[]).map(function(a){return a.certificate}),b=N(f,a);if(0===b.length)throw Error("Certificate for verification not found");return e.validateCertificate(b.concat(f))}))}).then(function(a){if(d.signerInfos)return Promise.all(d.signerInfos.map(function(b,c){var d=f;if(b.signedAttrs){if(!b.signedAttrs.messageDigest)throw Error("Message digest must present in signed attributes");d=l("SignedAttributes").encode(b.signedAttrs)}if(!d)throw Error("Data for verification not found");var e=
n(b.signatureAlgorithm,{hash:b.digestAlgorithm});return P(a[c][0],e,b.signatureValue,d)}))}).then(function(a){if(d.signerInfos){for(var b=0,c=a.length;b<c;b++)if(!0!==a[b])throw Error("Signature not verified");return Promise.all(d.signerInfos.map(function(a){return a.signedAttrs&&f?m().digest(a.digestAlgorithm,f):!1}))}return m().digest(d.digestAlgorithm,f)}).then(function(a){if(d.signerInfos)d.signerInfos.forEach(function(b,c){if(b.signedAttrs&&f&&0!==S(a[c],b.signedAttrs.messageDigest))throw Error("Data digest not verified");
});else if(0!==S(a,d.digest))throw Error("Data digest not verified");return{contentType:g&&g.eContentType||"data",content:f}})},decryptData:function(a,b,e){var c=this,d=c.keyStore,f,g,h,k,s,p,q,w;return(new r.Promise(u)).then(function(){var h=v(a,"ContentInfo");if("envelopedData"!==h.contentType&&"encryptedData"!==h.contentType)throw Error("Invalid enveloped or encrypted data format");f=h.content;var l=function(a){a:{for(var e=c.keyStore,f=e.aliases(),g=0,h=f.length;g<h;g++){var k=f[g];if(X(e.getCertificate(k),
a)){a=k;break a}}a=void 0}if(a){!b&&d.getKey(a)&&(b=a);if(b===a)return!0;m.push(a)}};q=f.encryptedContentInfo.contentEncryptionAlgorithm;w=c.provider;if("envelopedData"===h.contentType){for(var h=f.recipientInfos,m=[],p=0,u=h.length;p<u;p++){var t=h[p];if(t.ktri){g="keytrans";var y=t.ktri.rid;if(y&&y.issuerAndSerialNumber&&l({issuer:y.issuerAndSerialNumber.issuer,serialNumber:y.issuerAndSerialNumber.serialNumber})||y.subjectKeyIdentifier&&l({subjectKeyIdentifier:y.subjectKeyIdentifier}))k=t.ktri;
w=J(d.getCertificate(b))||c.provider}else if(t.kari){g="keyagree";for(var x=t.kari.recipientEncryptedKeys,C=0,E=x.length;C<E;C++)if((y=x[p].rid)&&y.issuerAndSerialNumber&&l({issuer:y.issuerAndSerialNumber.issuer,serialNumber:y.issuerAndSerialNumber.serialNumber})||y.subjectKeyIdentifier&&l({subjectKeyIdentifier:y.subjectKeyIdentifier})){k={originator:t.kari.originator,keyEncryptionAlgorithm:t.kari.keyEncryptionAlgorithm,ukm:t.kari.ukm,encryptedKey:x[p].encryptedKey};w=J(d.getCertificate(b))||c.provider;
break}}else if(t.kekri){g="kek";y=t.kekri.kekid.keyIdentifier;try{var D=(z||(z=r.gostCoding)).BER.decode(y);D instanceof String&&d.containsAlias(D)&&(b===D.toString()?k=t.kekri:m.push(D))}catch(I){l({subjectKeyIdentifier:y})&&(k=t.kekri)}}else if(t.pwri){g="pbkek";e=b;if(!e||"string"!==typeof e)throw Error("Password required");k=t.pwri}if(k)break}if(!k){if(0<m.length)throw Error("Recipient key required ["+m.join(",")+"]");throw Error("No recipient found in store");}}else if("PBES2"===q.id||"id-sc-pbeWithGost3411AndGost28147"===
q.id||"id-sc-pbeWithGost3411AndGost28147CFB"===q.id){if(g="pbes",e=b,!e||"string"!==typeof e)throw Error("Password required");}else if(g="keyman",!b)throw Error("Secret key alias required");switch(g){case "keytrans":case "keyagree":case "kek":case "keyman":return F(c,b,e);case "pbkek":s=n(w.derivation,{salt:k.keyDerivationAlgorithm.salt,iterations:k.keyDerivationAlgorithm.iterations,hmac:k.keyDerivationAlgorithm.hmac});break;case "pbes":l=q,s=n(w.derivation,{salt:l.derivation.salt,iterations:l.derivation.iterations,
hmac:l.derivation.hmac}),q=l.encryption}return G.subtle.importKey("raw",H().decode(e,"utf8"),s,!0,["deriveKey"])}).then(function(a){h=a;switch(g){case "keyagree":a=k.originator;if(a.originatorKey){var b=l("SubjectPublicKeyInfo").encode({algorithm:a.originatorKey.algorithm,subjectPublicKey:a.originatorKey.publicKey});return m().importKey("spki",b,a.originatorKey.algorithm,!0,["verify","deriveKey"])}if((a=I(d,a.issuerAndSerialNumber?{issuer:a.issuerAndSerialNumber.issuer,serialNumber:a.issuerAndSerialNumber.serialNumber}:
{subjectKeyIdentifier:a.subjectKeyIdentifier}))&&0<a.length)return O(a[0]);throw Error("Originator certificate not found in key stores");}}).then(function(a){switch(g){case "keytrans":s=n(w.agreement,{ukm:k.keyEncryptionAlgorithm.ukm,"public":k.keyEncryptionAlgorithm["public"],sBox:k.keyEncryptionAlgorithm.sBox});p=n(w.transwrapping||w.wrapping,k.keyEncryptionAlgorithm.wrapping,{ukm:k.keyEncryptionAlgorithm.ukm});break;case "keyagree":s=n(k.keyEncryptionAlgorithm,{ukm:k.ukm,"public":a});p=n(k.keyEncryptionAlgorithm.wrapping||
w.wrapping,{ukm:k.ukm});break;case "kek":return p=n(k.keyEncryptionAlgorithm),h;case "keyman":return h;case "pbkek":p=n(k.keyEncryptionAlgorithm);break;case "pbes":p=q}return m().deriveKey(s,h,p,!0,["unwrapKey","decrypt"])}).then(function(a){switch(g){case "pbes":case "keyman":return a;default:return m().unwrapKey("raw",k.encryptedKey,a,p,q,!0,["decrypt"])}}).then(function(a){return m().decrypt(q,a,f.encryptedContentInfo.encryptedContent)}).then(function(a){return{contentType:f.encryptedContentInfo.contentType,
content:a}})},extractData:function(a,b,e){var c=this;return(new r.Promise(u)).then(function(){var d=v(a,"ContentInfo");switch(d.contentType){case "data":return d.content;case "signedData":case "digestedData":return c.verifyData(a);case "encryptedData":case "envelopedData":return c.decryptData(a,b,e);default:throw Error("Data format not supported");}}).then(function(a){var f=a?a.contentType:!1;return"signedData"===f||"digestedData"===f||"encryptedData"===f||"envelopedData"===f?c.extractData(a.content,
b,e):a})}};return $});
